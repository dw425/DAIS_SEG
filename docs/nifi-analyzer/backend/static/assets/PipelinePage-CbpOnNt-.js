import{r as m,j as e,R as ne,c as Ve}from"./index-tIH9TuVJ.js";import{u as N,a as S,g as _e,A as Ge,b as B,e as Re,J as He,c as Ye,d as Ke,f as Je,l as qe,h as Qe,i as Xe}from"./AdminConsole-BUVybbMM.js";const pe={dataflow:"bg-blue-500/20 text-blue-400",etl:"bg-purple-500/20 text-purple-400",orchestrator:"bg-amber-500/20 text-amber-400",transform:"bg-green-500/20 text-green-400",warehouse:"bg-cyan-500/20 text-cyan-400",ingestion:"bg-pink-500/20 text-pink-400",compute:"bg-orange-500/20 text-orange-400",database:"bg-teal-500/20 text-teal-400"};function me(){const t=N(s=>s.stepStatuses);return m.useMemo(()=>{let r=0,a=0,l=0;for(let n=0;n<8;n++){const i=t[n];i==="done"?r++:i==="running"?a++:i==="error"&&l++}const o=Math.min(100,Math.round((r+a*.5)/8*100));return{completed:r,running:a,errored:l,total:8,percent:o}},[t])}function Ze(){const t=N(g=>g.setActiveStep),{completed:s,running:r,errored:a,total:l,percent:o}=me(),n=a>0?"text-red-400 border-red-500/50":r>0?"text-amber-400 border-amber-500/50":s===l?"text-green-400 border-green-500/50":"text-gray-400 border-gray-600",i=10,d=2*Math.PI*i,c=d-o/100*d,x=a>0?"#f87171":r>0?"#fbbf24":s===l?"#4ade80":"#6b7280";return e.jsxs("button",{onClick:()=>t(8),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg border ${n} bg-gray-800/50
        hover:bg-gray-800 transition text-xs font-medium`,title:"Go to Summary",children:[e.jsxs("svg",{width:"24",height:"24",className:"shrink-0",children:[e.jsx("circle",{cx:"12",cy:"12",r:i,fill:"none",stroke:"#374151",strokeWidth:"2"}),e.jsx("circle",{cx:"12",cy:"12",r:i,fill:"none",stroke:x,strokeWidth:"2",strokeLinecap:"round",strokeDasharray:d,strokeDashoffset:c,transform:"rotate(-90 12 12)",className:"transition-all duration-300"})]}),e.jsxs("span",{children:[s,"/",l," complete"]})]})}const et={success:"✓",error:"✖",warning:"⚠",info:"ℹ"},tt={success:"text-green-400",error:"text-red-400",warning:"text-amber-400",info:"text-blue-400"};function st(t){const s=Math.floor((Date.now()-t)/1e3);return s<60?`${s}s ago`:s<3600?`${Math.floor(s/60)}m ago`:s<86400?`${Math.floor(s/3600)}h ago`:`${Math.floor(s/86400)}d ago`}function rt(){const[t,s]=m.useState(!1),[r,a]=m.useState("all"),l=N(b=>b.toasts),o=N(b=>b.errors),n=m.useRef(null),i=l.slice().reverse(),d=r==="all"?i:i.filter(b=>b.type===r),c=o.length+l.filter(b=>b.type==="error").length;m.useEffect(()=>{if(!t)return;const b=p=>{n.current&&!n.current.contains(p.target)&&s(!1)};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[t]);const x=()=>{for(const b of l)N.getState().removeToast(b.id);N.getState().clearErrors()},g=["all","success","error","warning","info"];return e.jsxs("div",{ref:n,className:"relative",children:[e.jsxs("button",{onClick:()=>s(!t),className:"relative p-2 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-gray-800 transition",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),c>0&&e.jsx("span",{className:"absolute -top-0.5 -right-0.5 w-4 h-4 rounded-full bg-red-500 text-white text-[10px] flex items-center justify-center font-bold",children:c>9?"9+":c})]}),t&&e.jsxs("div",{className:"absolute top-full right-0 mt-1 w-80 bg-gray-900 border border-border rounded-lg shadow-xl z-50 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-border",children:[e.jsx("span",{className:"text-sm font-medium text-gray-200",children:"Notifications"}),e.jsx("button",{onClick:x,className:"text-xs text-gray-500 hover:text-gray-300 transition",children:"Clear All"})]}),e.jsx("div",{className:"flex gap-1 px-3 py-2 border-b border-border",children:g.map(b=>e.jsx("button",{onClick:()=>a(b),className:`px-2 py-0.5 rounded text-xs font-medium transition
                  ${r===b?"bg-primary/20 text-primary":"text-gray-500 hover:text-gray-300"}`,children:b==="all"?"All":b.charAt(0).toUpperCase()+b.slice(1)},b))}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:d.length===0?e.jsx("div",{className:"py-6 text-center text-sm text-gray-500",children:"No notifications"}):d.map(b=>e.jsxs("div",{className:"flex items-start gap-3 px-4 py-2.5 border-b border-border/30 hover:bg-gray-800/30",children:[e.jsx("span",{className:`mt-0.5 text-sm ${tt[b.type]}`,children:et[b.type]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-gray-300 truncate",children:b.message}),e.jsx("p",{className:"text-[10px] text-gray-600 mt-0.5",children:st(b.timestamp)})]})]},b.id))})]})]})}function at({users:t,connected:s,maxDisplay:r=5}){if(t.length===0)return null;const a=t.slice(0,r),l=t.length-r;return e.jsxs("div",{className:"flex items-center gap-1.5","aria-label":`${t.length} users online`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${s?"bg-green-400":"bg-gray-600"}`,title:s?"Connected":"Disconnected"}),e.jsxs("div",{className:"flex -space-x-2",children:[a.map(o=>e.jsx("div",{className:"w-7 h-7 rounded-full border-2 border-gray-900 flex items-center justify-center text-xs font-medium text-white",style:{backgroundColor:o.color},title:`${o.user} (Step ${o.step+1})`,"aria-label":`${o.user} is on step ${o.step+1}`,children:o.user.charAt(0).toUpperCase()},o.id)),l>0&&e.jsxs("div",{className:"w-7 h-7 rounded-full border-2 border-gray-900 bg-gray-700 flex items-center justify-center text-xs font-medium text-gray-300",title:`${l} more users`,children:["+",l]})]})]})}function nt(){const[t,s]=m.useState(!1),[r,a]=m.useState(""),l=S(x=>x.finalReport),o=S(x=>x.fileName),n=S(x=>x.platform),i=S(x=>x.parsed),d=S(x=>x.validation),c=async()=>{var x;s(!0),a("");try{const g=(l==null?void 0:l.sections)||[],b=await fetch("/api/export/pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:`ETL Migration Report - ${o||"Flow"}`,sections:g,summary:(l==null?void 0:l.executiveSummary)||"",platform:n||(i==null?void 0:i.platform)||"",fileName:o||"",processorCount:((x=i==null?void 0:i.processors)==null?void 0:x.length)||0,confidence:(d==null?void 0:d.overallScore)||0})});if(!b.ok)throw new Error(`Export failed: ${b.status}`);const p=await b.text(),j=window.open("","_blank");j&&(j.document.write(p),j.document.close())}catch(g){console.error("PDF export error:",g),a("PDF export failed. Please try again.")}finally{s(!1)}};return e.jsxs(e.Fragment,{children:[r&&e.jsx("span",{className:"text-xs text-red-400 mr-2",children:r}),e.jsxs("button",{onClick:c,disabled:t,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm rounded-lg bg-gray-800 border border-border text-gray-300 hover:bg-gray-700 hover:text-gray-100 transition disabled:opacity-50","aria-label":"Export report as PDF",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),t?"Generating...":"Export PDF"]})]})}const ue="etl-theme-mode";function Ae(){return typeof window>"u"||window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Z(t){const s=t==="system"?Ae():t,r=document.documentElement;s==="dark"?r.classList.add("dark"):r.classList.remove("dark")}function ot(){const[t,s]=m.useState(()=>typeof window>"u"?"dark":localStorage.getItem(ue)||"dark"),r=m.useCallback(l=>{s(l),localStorage.setItem(ue,l),Z(l)},[]);m.useEffect(()=>{if(Z(t),t==="system"){const l=window.matchMedia("(prefers-color-scheme: dark)"),o=()=>Z("system");return l.addEventListener("change",o),()=>l.removeEventListener("change",o)}},[t]);const a=t==="system"?Ae():t;return{mode:t,setMode:r,resolvedTheme:a}}function lt(){const[t,s]=m.useState([]),[r,a]=m.useState(!1),l=m.useRef(null),o=m.useRef(),n=m.useCallback(()=>{try{const c=window.location.protocol==="https:"?"wss:":"ws:",x=window.location.host,g=new WebSocket(`${c}//${x}/ws/presence`);g.onopen=()=>{a(!0)},g.onmessage=b=>{try{const p=JSON.parse(b.data);p.type==="presence"&&s(p.users||[])}catch(p){console.warn("Presence: failed to parse WebSocket message",p)}},g.onclose=()=>{a(!1),l.current=null,o.current=setTimeout(n,5e3)},g.onerror=()=>{g.close()},l.current=g}catch(c){console.warn("Presence: WebSocket connection failed",c)}},[]);m.useEffect(()=>(n(),()=>{o.current&&clearTimeout(o.current),l.current&&(l.current.close(),l.current=null)}),[n]);const i=m.useCallback(c=>{var x;((x=l.current)==null?void 0:x.readyState)===WebSocket.OPEN&&l.current.send(JSON.stringify({step:c}))},[]),d=m.useCallback(c=>{var x;((x=l.current)==null?void 0:x.readyState)===WebSocket.OPEN&&l.current.send(JSON.stringify({user:c}))},[]);return{users:t,connected:r,updateStep:i,updateUser:d}}const it=[{id:"nifi",name:"Apache NiFi",formats:[".xml",".json",".gz",".zip",".nar"],category:"dataflow",versions:["1.x","2.x"]},{id:"ssis",name:"SQL Server SSIS",formats:[".dtsx",".ispac"],category:"etl",versions:["2012","2014","2016","2017","2019","2022"]},{id:"informatica",name:"Informatica PowerCenter",formats:[".xml",".zip"],category:"etl",versions:["9.x","10.x"]},{id:"talend",name:"Talend",formats:[".item",".properties",".zip"],category:"etl",versions:["7.x","8.x"]},{id:"airflow",name:"Apache Airflow",formats:[".py"],category:"orchestrator",versions:["1.x","2.x"]},{id:"dbt",name:"dbt",formats:[".json",".sql",".yml"],category:"transform",versions:["1.x"]},{id:"adf",name:"Azure Data Factory",formats:[".json"],category:"orchestrator",versions:["v2"]},{id:"glue",name:"AWS Glue",formats:[".json",".py"],category:"etl",versions:["3.0","4.0"]},{id:"snowflake",name:"Snowflake",formats:[".sql"],category:"warehouse",versions:["current"]},{id:"spark",name:"Existing Spark Jobs",formats:[".py",".scala",".jar"],category:"compute",versions:["2.x","3.x"]},{id:"sql",name:"Generic SQL",formats:[".sql"],category:"database",versions:["ANSI","Oracle","MySQL","PostgreSQL","T-SQL"]}];function ct(){const t=N(f=>f.sidebarMode),s=N(f=>f.setSidebarMode),r=N(f=>f.setSettingsOpen),a=N(f=>f.setHelpOpen),l=N(f=>f.setSearchOpen),o=S(f=>f.platform),n=S(f=>f.setPlatform),[i,d]=m.useState(!1),[c,x]=m.useState(it);m.useEffect(()=>{_e().then(f=>{Array.isArray(f.platforms)&&f.platforms.length>0&&x(f.platforms)}).catch(()=>{})},[]);const{mode:g,setMode:b}=ot(),{users:p,connected:j}=lt(),u=()=>{const f=["dark","light","system"],w=f.indexOf(g);b(f[(w+1)%f.length])},h=c.find(f=>f.id===o);return e.jsxs("header",{className:"h-14 shrink-0 bg-gray-900/80 border-b border-border backdrop-blur-sm flex items-center px-4 gap-4 z-30",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary/20 flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsx("h1",{className:"text-base font-semibold text-gray-100 hidden sm:block",children:"ETL Migration Platform"})]}),e.jsxs("div",{className:"relative ml-4",children:[e.jsxs("button",{onClick:()=>d(!i),className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-gray-800 border border-border hover:border-gray-600 transition text-sm",children:[h?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs ${pe[h.category]||""}`,children:h.category}),e.jsx("span",{className:"text-gray-200",children:h.name})]}):e.jsx("span",{className:"text-gray-400",children:"Auto-detect platform"}),e.jsx("svg",{className:"w-3.5 h-3.5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>d(!1)}),e.jsxs("div",{className:"absolute top-full left-0 mt-1 w-64 bg-gray-900 border border-border rounded-lg shadow-xl z-50 max-h-80 overflow-y-auto",children:[e.jsx("button",{onClick:()=>{n(null),d(!1)},className:"w-full text-left px-3 py-2 text-sm text-gray-400 hover:bg-gray-800 transition",children:"Auto-detect"}),c.map(f=>e.jsxs("button",{onClick:()=>{n(f.id),d(!1)},className:`
                    w-full text-left px-3 py-2 text-sm hover:bg-gray-800 transition flex items-center gap-2
                    ${o===f.id?"bg-primary/10 text-gray-100":"text-gray-300"}
                  `,children:[e.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs ${pe[f.category]||""}`,children:f.category}),e.jsx("span",{children:f.name})]},f.id))]})]})]}),e.jsx(Ge,{}),e.jsx("div",{className:"flex-1"}),e.jsx(Ze,{}),e.jsx("button",{onClick:()=>l(!0),className:"p-2 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-gray-800 transition",title:"Search (Ctrl+K)","aria-label":"Open search overlay (Ctrl+K)",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx(rt,{}),e.jsx(at,{users:p,connected:j}),e.jsx(nt,{}),e.jsx("button",{onClick:u,className:"p-2 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-gray-800 transition",title:`Theme: ${g}`,"aria-label":`Current theme: ${g}. Click to change.`,children:g==="dark"?e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}):g==="light"?e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),e.jsx("button",{onClick:()=>s(!t),className:"p-2 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-gray-800 transition",title:t?"Switch to tab layout":"Switch to sidebar layout","aria-label":t?"Switch to tab layout":"Switch to sidebar layout",children:t?e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}):e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7"})})}),e.jsx("button",{onClick:()=>a(!0),className:"p-2 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-gray-800 transition",title:"Help","aria-label":"Open help panel",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("button",{onClick:()=>r(!0),className:"p-2 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-gray-800 transition",title:"Settings","aria-label":"Open settings panel",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.066 2.573c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.573 1.066c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.066-2.573c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})}const dt={idle:e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-gray-600 flex items-center justify-center text-xs text-gray-500"}),running:e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-primary flex items-center justify-center",children:e.jsx("div",{className:"w-3 h-3 rounded-full border-2 border-primary border-t-transparent animate-spin"})}),done:e.jsx("div",{className:"w-6 h-6 rounded-full bg-green-500/20 border-2 border-green-500 flex items-center justify-center",children:e.jsx("svg",{className:"w-3.5 h-3.5 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),error:e.jsx("div",{className:"w-6 h-6 rounded-full bg-red-500/20 border-2 border-red-500 flex items-center justify-center",children:e.jsx("svg",{className:"w-3.5 h-3.5 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})})};function xt({stepNumber:t,label:s,status:r,active:a,disabled:l,onClick:o}){return e.jsxs("button",{onClick:o,disabled:l,className:`
        w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all text-left
        ${a?"bg-primary/10 border border-primary/30":"hover:bg-gray-800/50 border border-transparent"}
        ${l?"opacity-40 cursor-not-allowed":"cursor-pointer"}
      `,children:[dt[r],e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500 font-mono",children:t}),e.jsx("span",{className:`text-sm truncate ${a?"text-gray-100 font-medium":"text-gray-400"}`,children:s})]}),r==="running"&&e.jsx("div",{className:"mt-1.5 h-1 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary rounded-full animate-[progress_2s_ease-in-out_infinite]",style:{width:"60%"}})})]})]})}const mt=["Parse Flow","Analyze","Assess & Map","Convert","Migration Report","Final Report","Validate","Value Analysis"],pt=[{label:"Summary",icon:"Σ",idx:8},{label:"Admin",icon:"⚙",idx:9},{label:"Dashboard",icon:"▣",idx:10},{label:"History",icon:"⌚",idx:11},{label:"Compare",icon:"↔",idx:12}],ut="5.0.0";function gt(){const t=N(n=>n.activeStep),s=N(n=>n.stepStatuses),r=N(n=>n.setActiveStep),[a,l]=m.useState(!1),o=n=>n>=8||n===t||n===0||s[n]==="done"||s[n]==="error"||s[n]==="running"||n>0&&s[n-1]==="done";return e.jsxs("aside",{className:`
        shrink-0 bg-gray-900/50 border-r border-border flex flex-col transition-all
        ${a?"w-14":"w-60"}
      `,children:[e.jsx("button",{onClick:()=>l(!a),className:"p-2 text-gray-500 hover:text-gray-300 self-end",title:a?"Expand sidebar":"Collapse sidebar","aria-label":a?"Expand sidebar":"Collapse sidebar",children:e.jsx("svg",{className:`w-4 h-4 transition-transform ${a?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})}),e.jsxs("nav",{className:"flex-1 overflow-y-auto px-2 space-y-1 pb-4",children:[mt.map((n,i)=>e.jsx(ne.Fragment,{children:a?e.jsx("button",{onClick:()=>o(i)&&r(i),disabled:!o(i),title:n,className:`
                  w-10 h-10 flex items-center justify-center rounded-lg text-xs font-mono transition
                  ${i===t?"bg-primary/10 text-primary":"text-gray-500 hover:bg-gray-800"}
                  ${o(i)?"cursor-pointer":"opacity-40 cursor-not-allowed"}
                `,children:i+1}):e.jsx(xt,{stepNumber:i+1,label:n,status:s[i],active:i===t,disabled:!o(i),onClick:()=>r(i)})},i)),e.jsx("hr",{className:"border-border my-3"}),pt.map(n=>e.jsx(ne.Fragment,{children:a?e.jsx("button",{onClick:()=>r(n.idx),title:n.label,className:`
                  w-10 h-10 flex items-center justify-center rounded-lg text-sm transition cursor-pointer
                  ${n.idx===t?"bg-primary/10 text-primary":"text-gray-500 hover:bg-gray-800 hover:text-gray-300"}
                `,children:n.icon}):e.jsxs("button",{onClick:()=>r(n.idx),className:`
                  w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all text-left cursor-pointer
                  ${n.idx===t?"bg-primary/10 border border-primary/30 text-gray-100":"hover:bg-gray-800/50 border border-transparent text-gray-400 hover:text-gray-200"}
                `,children:[e.jsx("span",{className:"w-6 h-6 flex items-center justify-center text-sm",children:n.icon}),e.jsx("span",{className:"text-sm",children:n.label})]})},n.idx))]}),!a&&e.jsx("div",{className:"px-4 py-2 border-t border-border",children:e.jsxs("span",{className:"text-xs text-gray-600",children:["v",ut]})})]})}function ht(){const{completed:t,running:s,errored:r,total:a,percent:l}=me(),o=r>0?"bg-red-500":s>0?"bg-primary":t===a?"bg-green-500":"bg-blue-500";return e.jsxs("div",{className:"h-8 shrink-0 bg-gray-900/80 border-t border-border flex items-center px-4 gap-3",children:[e.jsx("div",{className:"flex-1 h-1.5 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${o}`,style:{width:`${l}%`}})}),e.jsxs("span",{className:"text-xs text-gray-500 tabular-nums",children:[t,"/",a," steps"]}),e.jsxs("span",{className:"text-xs text-gray-600 tabular-nums",children:[l,"%"]})]})}function bt(){const t=N(c=>c.errors),s=N(c=>c.clearErrors),r=N(c=>c.removeError),[a,l]=m.useState(!1),[o,n]=m.useState(new Set);if(t.length===0)return null;const i=c=>{n(x=>{const g=new Set(x);return g.has(c)?g.delete(c):g.add(c),g})},d=c=>{switch(c){case"error":return e.jsx("span",{className:"text-red-400",children:"✖"});case"warning":return e.jsx("span",{className:"text-amber-400",children:"⚠"});default:return e.jsx("span",{className:"text-blue-400",children:"ℹ"})}};return e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 z-50 bg-gray-900 border-t border-red-500/30",children:[e.jsxs("button",{onClick:()=>l(!a),className:"w-full flex items-center justify-between px-4 py-2 hover:bg-gray-800/50 transition",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-red-400 text-sm font-medium",children:[t.length," error",t.length!==1?"s":""]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:c=>{c.stopPropagation(),s()},className:"text-xs text-gray-500 hover:text-gray-300 px-2 py-0.5 rounded bg-gray-800",children:"Clear all"}),e.jsx("svg",{className:`w-4 h-4 text-gray-400 transition-transform ${a?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})]})]}),a&&e.jsx("div",{className:"max-h-64 overflow-y-auto px-4 pb-3 space-y-2",children:t.map(c=>e.jsxs("div",{className:"flex items-start gap-2 bg-gray-800/50 rounded-lg p-3 text-sm",children:[e.jsx("div",{className:"mt-0.5",children:d(c.severity)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-gray-200",children:c.message}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(c.timestamp).toLocaleTimeString()}),c.stack&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i(c.id),className:"text-xs text-gray-500 hover:text-gray-300 mt-1 underline",children:[o.has(c.id)?"Hide":"Show"," stack trace"]}),o.has(c.id)&&e.jsx("pre",{className:"text-xs text-gray-500 mt-1 whitespace-pre-wrap font-mono bg-gray-900 rounded p-2 overflow-x-auto",children:c.stack})]})]}),e.jsx("button",{onClick:()=>r(c.id),className:"text-gray-500 hover:text-gray-300 shrink-0",children:"✕"})]},c.id))})]})}function ft(){const t=N(l=>l.errorModal),s=N(l=>l.setErrorModal),[r,a]=m.useState(!1);return t?e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm",onClick:()=>s(null),children:e.jsxs("div",{className:"bg-gray-900 border border-red-500/40 rounded-xl shadow-2xl max-w-lg w-full mx-4 overflow-hidden",onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-3 px-6 py-4 bg-red-500/10 border-b border-red-500/20",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-red-500/20 flex items-center justify-center shrink-0",children:e.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("h3",{className:"text-base font-semibold text-red-300",children:["Step ",t.step," Failed: ",t.stepName]})}),e.jsx("button",{onClick:()=>s(null),className:"text-gray-400 hover:text-gray-200 shrink-0",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"px-6 py-5 space-y-4",children:[t.status&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"HTTP Status"}),e.jsx("span",{className:"px-2 py-0.5 rounded bg-red-500/20 text-red-300 text-sm font-mono",children:t.status})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider block mb-1",children:"Error Message"}),e.jsx("div",{className:"bg-gray-800 rounded-lg p-3 text-sm text-gray-200 font-mono break-words",children:t.message})]}),t.stack&&e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>a(!r),className:"text-xs text-gray-500 hover:text-gray-300 underline",children:[r?"Hide":"Show"," stack trace"]}),r&&e.jsx("pre",{className:"mt-2 bg-gray-800 rounded-lg p-3 text-xs text-gray-400 font-mono overflow-x-auto max-h-48 overflow-y-auto whitespace-pre-wrap",children:t.stack})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-border flex items-center justify-between",children:[e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(`Step ${t.step}: ${t.stepName}
Status: ${t.status||"N/A"}
Error: ${t.message}
${t.stack||""}`)},className:"text-xs text-gray-400 hover:text-gray-200 px-3 py-1.5 rounded bg-gray-700 hover:bg-gray-600 transition",children:"Copy to Clipboard"}),e.jsx("button",{onClick:()=>s(null),className:"text-sm text-gray-200 px-4 py-2 rounded-lg bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 transition",children:"Dismiss"})]})]})}):null}const yt=["Parse Flow","Analyze","Assess & Map","Convert","Migration Report","Final Report","Validate","Value Analysis"];function Le(t){if(t<60)return`${t}s`;const s=Math.floor(t/60),r=t%60;return`${s}m ${r}s`}function jt({index:t,name:s,status:r,startTime:a}){const[l,o]=m.useState(0);m.useEffect(()=>{if(r!=="running"||!a){o(0);return}const x=setInterval(()=>{o(Math.floor((Date.now()-a)/1e3))},1e3);return()=>clearInterval(x)},[r,a]);const n=r==="done"?"bg-green-500":r==="running"?"bg-cyan-500":r==="error"?"bg-red-500":"bg-gray-700",i=r==="done"||r==="error"?"100%":"0%",d=r==="done"?"Complete":r==="running"?`Running... ${Le(l)}`:r==="error"?"Failed":"Pending",c=r==="done"?"text-green-400":r==="running"?"text-cyan-400":r==="error"?"text-red-400":"text-gray-500";return e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-6 text-right text-sm font-mono text-gray-500",children:t+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("span",{className:`text-sm font-medium ${r==="running"?"text-gray-100":r==="done"?"text-green-300":r==="error"?"text-red-300":"text-gray-400"}`,children:[s,r==="running"&&e.jsx("span",{className:"ml-2 inline-block w-1.5 h-1.5 rounded-full bg-cyan-400 animate-ping"})]}),e.jsx("span",{className:`text-xs font-mono ${c}`,children:d})]}),e.jsx("div",{className:"h-2.5 bg-gray-800 rounded-full overflow-hidden",children:r==="running"?e.jsx("div",{className:"h-full bg-cyan-500 rounded-full animate-indeterminate"}):e.jsx("div",{className:`h-full rounded-full transition-all duration-700 ${n}`,style:{width:i}})})]})]})}function vt(){const t=N(p=>p.stepStatuses),s=N(p=>p.progress),r=N(p=>p.pipelineRunning),a=S(p=>p.fileName),l=S(p=>p.platform),[o,n]=m.useState(Array(8).fill(null)),[i]=m.useState(()=>Date.now()),[d,c]=m.useState(0);m.useEffect(()=>{n(p=>{const j=[...p];for(let u=0;u<8;u++)t[u]==="running"&&!j[u]?j[u]=Date.now():t[u]!=="running"&&(j[u]=null);return j})},[t]),m.useEffect(()=>{if(!r)return;const p=setInterval(()=>{c(Math.floor((Date.now()-i)/1e3))},1e3);return()=>clearInterval(p)},[r,i]);const x=t.slice(0,8).filter(p=>p==="done").length,g=t.slice(0,8).some(p=>p==="error"),b=t.slice(0,8).some(p=>p==="running");return e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsx("style",{children:`
        @keyframes indeterminate {
          0% { width: 0%; margin-left: 0%; }
          50% { width: 40%; margin-left: 30%; }
          100% { width: 0%; margin-left: 100%; }
        }
        .animate-indeterminate {
          animation: indeterminate 1.5s ease-in-out infinite;
        }
      `}),e.jsxs("div",{className:"rounded-xl border border-border bg-gray-900/60 p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[b&&e.jsx("div",{className:"w-5 h-5 border-2 border-cyan-400 border-t-transparent rounded-full animate-spin"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-100",children:g?"Pipeline Error":b?"Pipeline Running":"Pipeline Complete"})]}),e.jsxs("p",{className:"text-sm text-gray-400",children:[a&&e.jsxs(e.Fragment,{children:["Processing ",e.jsx("span",{className:"text-gray-300 font-medium",children:a})]}),l&&e.jsxs(e.Fragment,{children:[" (",l,")"]})]}),r&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1 font-mono",children:["Elapsed: ",Le(d)]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Overall Progress"}),e.jsxs("span",{className:"text-sm font-mono text-gray-300",children:[x,"/8 steps · ",s,"%"]})]}),e.jsx("div",{className:"h-3 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-700 ${g?"bg-red-500":"bg-cyan-500"}`,style:{width:`${s}%`}})})]}),e.jsx("div",{className:"space-y-4",children:yt.map((p,j)=>e.jsx(jt,{index:j,name:p,status:t[j],startTime:o[j]},j))}),g&&e.jsxs("div",{className:"mt-6 p-4 rounded-lg bg-red-500/10 border border-red-500/20",children:[e.jsx("p",{className:"text-sm text-red-300",children:"A step failed. Check the error modal for details."}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"You can dismiss the error and retry, or check the server logs for more info."})]}),b&&e.jsx("div",{className:"mt-6 text-center",children:e.jsx("p",{className:"text-xs text-gray-500",children:"Large flows (10,000+ processors) may take several minutes per step. The pipeline is still running."})})]})]})}const Nt={success:"bg-green-900/80 border-green-500/50 text-green-200",error:"bg-red-900/80 border-red-500/50 text-red-200",warning:"bg-amber-900/80 border-amber-500/50 text-amber-200",info:"bg-blue-900/80 border-blue-500/50 text-blue-200"},wt={success:"✓",error:"✖",warning:"⚠",info:"ℹ"};function kt({toast:t}){const s=N(r=>r.removeToast);return m.useEffect(()=>{const r=setTimeout(()=>s(t.id),4e3);return()=>clearTimeout(r)},[t.id,s]),e.jsxs("div",{className:`flex items-center gap-2 px-4 py-3 rounded-lg border shadow-lg backdrop-blur-sm
        text-sm animate-[slideIn_0.3s_ease-out] ${Nt[t.type]}`,children:[e.jsx("span",{className:"text-base",children:wt[t.type]}),e.jsx("span",{className:"flex-1",children:t.message}),e.jsx("button",{onClick:()=>s(t.id),className:"opacity-60 hover:opacity-100 text-xs ml-2",children:"✕"})]})}function St(){const t=N(s=>s.toasts);return t.length===0?null:e.jsx("div",{className:"fixed top-4 right-4 z-[100] flex flex-col gap-2 max-w-sm",children:t.map(s=>e.jsx(kt,{toast:s},s.id))})}const Ct=["Processors","Mappings","Security Findings","Gaps"];function Et(){const t=N(h=>h.searchOpen),s=N(h=>h.setSearchOpen),r=N(h=>h.setActiveStep),a=S(),[l,o]=m.useState(""),[n,i]=m.useState(-1),d=m.useRef(null),c=m.useRef(null);m.useEffect(()=>{t&&(o(""),setTimeout(()=>{var h;return(h=d.current)==null?void 0:h.focus()},50))},[t]),m.useEffect(()=>{const h=f=>{f.key==="Escape"&&t&&s(!1)};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[t,s]);const x=m.useMemo(()=>{var f,w,C,L;const h=[];if((f=a.parsed)!=null&&f.processors)for(const M of a.parsed.processors)h.push({category:"Processors",icon:"⚙",name:M.name,type:M.type,tag:M.platform||"processor",targetStep:0});if((w=a.assessment)!=null&&w.mappings)for(const M of a.assessment.mappings)h.push({category:"Mappings",icon:"↔",name:M.name,type:M.type,tag:M.category,targetStep:2});if((C=a.analysis)!=null&&C.securityFindings)for(const M of a.analysis.securityFindings){const $=M;h.push({category:"Security Findings",icon:"⚠",name:String($.title||$.name||$.type||"Finding"),type:String($.severity||$.type||"security"),tag:"security",targetStep:1})}if((L=a.report)!=null&&L.gapPlaybook)for(const M of a.report.gapPlaybook)h.push({category:"Gaps",icon:"✖",name:M.processor,type:M.severity,tag:M.gap,targetStep:4});return h},[a.parsed,a.assessment,a.analysis,a.report]),g=m.useMemo(()=>{if(!l.trim())return x;const h=l.toLowerCase();return x.filter(f=>f.name.toLowerCase().includes(h)||f.type.toLowerCase().includes(h)||f.tag.toLowerCase().includes(h)||f.category.toLowerCase().includes(h))},[x,l]),b=m.useMemo(()=>{const h=new Map;for(const f of Ct){const w=g.filter(C=>C.category===f);w.length>0&&h.set(f,w.slice(0,10))}return h},[g]),p=m.useMemo(()=>{const h=[];for(const[,f]of b)h.push(...f);return h},[b]);m.useEffect(()=>{i(-1)},[l,p.length]);const j=h=>{r(h.targetStep),s(!1)},u=h=>{h.key==="ArrowDown"?(h.preventDefault(),i(f=>f<p.length-1?f+1:0)):h.key==="ArrowUp"?(h.preventDefault(),i(f=>f>0?f-1:p.length-1)):h.key==="Enter"&&n>=0&&n<p.length&&(h.preventDefault(),j(p[n]))};return m.useEffect(()=>{var h;n>=0&&c.current&&((h=c.current.querySelectorAll("[data-search-item]")[n])==null||h.scrollIntoView({block:"nearest"}))},[n]),t?e.jsxs("div",{className:"fixed inset-0 z-[200] flex items-start justify-center pt-[15vh]",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>s(!1)}),e.jsxs("div",{className:"relative w-full max-w-lg bg-gray-900 border border-border rounded-xl shadow-2xl overflow-hidden",onKeyDown:u,children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 border-b border-border",children:[e.jsx("svg",{className:"w-5 h-5 text-gray-500 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{ref:d,value:l,onChange:h=>o(h.target.value),placeholder:"Search processors, mappings, findings, gaps...",className:"flex-1 bg-transparent text-gray-100 text-sm outline-none placeholder:text-gray-500"}),e.jsx("kbd",{className:"hidden sm:inline-block px-1.5 py-0.5 text-[10px] font-mono bg-gray-800 text-gray-500 rounded border border-gray-700",children:"ESC"})]}),e.jsx("div",{ref:c,className:"max-h-80 overflow-y-auto p-2",children:b.size===0?e.jsx("div",{className:"py-8 text-center text-sm text-gray-500",children:x.length===0?"No pipeline data loaded. Run the pipeline first.":"No results found."}):(()=>{let h=0;return Array.from(b.entries()).map(([f,w])=>e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"px-2 py-1 text-[10px] font-semibold uppercase tracking-wider text-gray-500",children:[f," (",w.length,")"]}),w.map((C,L)=>{const M=h++;return e.jsxs("button",{"data-search-item":!0,onClick:()=>j(C),className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition text-left ${M===n?"bg-gray-800 ring-1 ring-primary/50":"hover:bg-gray-800"}`,children:[e.jsx("span",{className:"text-base w-5 text-center shrink-0",children:C.icon}),e.jsx("span",{className:"flex-1 text-gray-200 truncate",children:C.name}),e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] bg-gray-800 text-gray-400 border border-gray-700",children:C.type}),e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] bg-primary/10 text-primary",children:C.tag})]},`${f}-${L}`)})]},f))})()}),e.jsxs("div",{className:"px-4 py-2 border-t border-border text-[10px] text-gray-600 flex gap-4",children:[e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1 bg-gray-800 rounded",children:"↑↓"})," Navigate"]}),e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1 bg-gray-800 rounded",children:"↵"})," Select"]}),e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1 bg-gray-800 rounded",children:"Esc"})," Close"]})]})]})]}):null}const $e="etl-migration-settings",ee={apiBaseUrl:"/api",darkMode:!0,autoAdvance:!0,defaultCatalog:"",defaultSchema:"",defaultScope:"",sidebarMode:!0};function Mt(){try{const t=localStorage.getItem($e);if(t)return JSON.parse(t)}catch(t){console.warn("Settings: failed to load from localStorage",t)}return{}}function ge(t){try{localStorage.setItem($e,JSON.stringify(t))}catch(s){console.warn("Settings: failed to save to localStorage",s)}}const Rt=Ve((t,s)=>({...ee,...Mt(),get:r=>s()[r],set:(r,a)=>{t({[r]:a});const l=s();ge({apiBaseUrl:l.apiBaseUrl,darkMode:l.darkMode,autoAdvance:l.autoAdvance,defaultCatalog:l.defaultCatalog,defaultSchema:l.defaultSchema,defaultScope:l.defaultScope,sidebarMode:l.sidebarMode})},resetDefaults:()=>{t(ee),ge(ee)}}));function he({checked:t,onChange:s,label:r}){return e.jsxs("label",{className:"flex items-center justify-between gap-3 py-2",children:[e.jsx("span",{className:"text-sm text-gray-300",children:r}),e.jsx("button",{type:"button",onClick:()=>s(!t),className:`relative w-10 h-5 rounded-full transition ${t?"bg-primary":"bg-gray-700"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-4 h-4 rounded-full bg-white transition-transform
            ${t?"translate-x-5":"translate-x-0"}`})})]})}function Y({label:t,value:s,onChange:r,placeholder:a}){return e.jsxs("label",{className:"block py-2",children:[e.jsx("span",{className:"text-sm text-gray-300 block mb-1",children:t}),e.jsx("input",{type:"text",value:s,onChange:l=>r(l.target.value),placeholder:a,className:`w-full px-3 py-2 rounded-lg bg-gray-800 border border-border text-sm text-gray-200
          placeholder:text-gray-600 focus:outline-none focus:border-primary transition`})]})}function At(){const t=N(a=>a.settingsOpen),s=N(a=>a.setSettingsOpen),r=Rt();return t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/40 z-[150]",onClick:()=>s(!1)}),e.jsx("div",{className:`fixed top-0 right-0 h-full w-80 bg-gray-900 border-l border-border shadow-2xl z-[151]
        animate-[slideInRight_0.2s_ease-out] overflow-y-auto`,children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-100",children:"Settings"}),e.jsx("button",{onClick:()=>s(!1),className:"p-1 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-gray-800 transition",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500 mb-2",children:"API Configuration"}),e.jsx(Y,{label:"API Base URL",value:r.apiBaseUrl,onChange:a=>r.set("apiBaseUrl",a),placeholder:"/api"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500 mb-2",children:"Behavior"}),e.jsx(he,{label:"Auto-advance steps",checked:r.autoAdvance,onChange:a=>r.set("autoAdvance",a)}),e.jsx(he,{label:"Sidebar mode",checked:r.sidebarMode,onChange:a=>r.set("sidebarMode",a)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500 mb-2",children:"Databricks Defaults"}),e.jsx(Y,{label:"Default Catalog",value:r.defaultCatalog,onChange:a=>r.set("defaultCatalog",a),placeholder:"main"}),e.jsx(Y,{label:"Default Schema",value:r.defaultSchema,onChange:a=>r.set("defaultSchema",a),placeholder:"default"}),e.jsx(Y,{label:"Default Scope",value:r.defaultScope,onChange:a=>r.set("defaultScope",a),placeholder:"migration"})]}),e.jsx("div",{className:"pt-4 border-t border-border",children:e.jsx("button",{onClick:r.resetDefaults,className:`w-full px-4 py-2 rounded-lg bg-red-500/20 text-red-400 text-sm font-medium
                hover:bg-red-500/30 transition`,children:"Reset to Defaults"})})]})})]}):null}const Lt=[{name:"1. Parse",desc:"Upload an ETL flow file (NiFi XML/JSON, SSIS DTSX, Airflow DAG, etc.) to extract processors, connections, and metadata."},{name:"2. Analyze",desc:"Examine the dependency graph, detect cycles, identify external systems, and surface security findings."},{name:"3. Assess",desc:"Map each processor to its Databricks equivalent, with confidence scores and migration notes."},{name:"4. Convert",desc:"Generate a Databricks notebook with PySpark/SQL cells that implement the mapped logic."},{name:"5. Report",desc:"View the gap playbook, risk matrix, and estimated migration timeline."},{name:"6. Final Report",desc:"Executive summary combining all analysis into a comprehensive migration document."},{name:"7. Validate",desc:"Score the generated notebook across dimensions like completeness, correctness, and security."},{name:"8. Value Analysis",desc:"Identify droppable processors, complexity breakdown, ROI estimate, and implementation roadmap."},{name:"9. Summary",desc:"Overview dashboard showing all pipeline results at a glance."},{name:"10. Admin",desc:"Debug tools: log viewer, state inspector, code validator."}],$t=[{keys:"Ctrl/Cmd + K",action:"Open search"},{keys:"Ctrl/Cmd + 1-8",action:"Navigate to step 1-8"},{keys:"Ctrl/Cmd + 9",action:"Go to Summary"},{keys:"Ctrl/Cmd + 0",action:"Go to Admin"},{keys:"Escape",action:"Close panels/overlays"}],Dt=["Apache NiFi","SQL Server SSIS","Informatica","Talend","Apache Airflow","dbt","Azure Data Factory","AWS Glue","Snowflake","Spark","Generic SQL","Matillion","Fivetran","Stitch","Pentaho","DataStage","Ab Initio","StreamSets","Apache Beam","Apache Flink","Apache Kafka","Dagster"],Pt=[{q:"What file formats are supported?",a:"XML, JSON, GZ, ZIP, DTSX, PY, SQL files from 22+ ETL platforms."},{q:"Is my data sent to the cloud?",a:"All processing runs locally via the backend API. No data is sent externally."},{q:"Can I re-run individual steps?",a:"Yes, navigate to any step and click the run button to re-execute it."},{q:"How is confidence calculated?",a:"Confidence reflects the completeness of the mapping: 1:1 API matches score 90%+, partial matches 50-89%."}];function be({title:t,children:s,defaultOpen:r}){const[a,l]=m.useState(r||!1);return e.jsxs("div",{className:"border border-border rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>l(!a),className:`w-full flex items-center justify-between px-4 py-3 text-sm font-medium text-gray-200
          hover:bg-gray-800/50 transition`,children:[t,e.jsx("svg",{className:`w-4 h-4 text-gray-500 transition-transform ${a?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a&&e.jsx("div",{className:"px-4 pb-3 text-sm text-gray-400",children:s})]})}function Tt(){const t=N(a=>a.helpOpen),s=N(a=>a.setHelpOpen),r=N(a=>a.activeStep);return t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/40 z-[150]",onClick:()=>s(!1)}),e.jsx("div",{className:`fixed top-0 right-0 h-full w-96 bg-gray-900 border-l border-border shadow-2xl z-[151]
        animate-[slideInRight_0.2s_ease-out] overflow-y-auto`,children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-100",children:"Help"}),e.jsx("button",{onClick:()=>s(!1),className:"p-1 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-gray-800 transition",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500 mb-3",children:"Keyboard Shortcuts"}),e.jsx("table",{className:"w-full text-sm",children:e.jsx("tbody",{children:$t.map(a=>e.jsxs("tr",{className:"border-b border-border/50",children:[e.jsx("td",{className:"py-1.5 pr-3",children:e.jsx("kbd",{className:"px-1.5 py-0.5 text-xs font-mono bg-gray-800 text-gray-400 rounded border border-gray-700",children:a.keys})}),e.jsx("td",{className:"py-1.5 text-gray-400",children:a.action})]},a.keys))})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500 mb-3",children:"Step Guide"}),e.jsx("div",{className:"space-y-2",children:Lt.map((a,l)=>e.jsx(be,{title:a.name,defaultOpen:l===r,children:a.desc},l))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500 mb-3",children:"Supported Platforms"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Dt.map(a=>e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded bg-gray-800/50 text-xs text-gray-300",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-400"}),a]},a))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500 mb-3",children:"FAQ"}),e.jsx("div",{className:"space-y-2",children:Pt.map((a,l)=>e.jsx(be,{title:a.q,children:a.a},l))})]})]})})]}):null}function Ft({targetId:t="main-content",label:s="Skip to main content"}){return e.jsx("a",{href:`#${t}`,className:"sr-only focus:not-sr-only focus:absolute focus:top-2 focus:left-2 focus:z-[100] focus:px-4 focus:py-2 focus:bg-primary focus:text-white focus:rounded-lg focus:text-sm focus:font-medium focus:outline-none",children:s})}const Ot={".xml":"bg-blue-500/20 text-blue-400",".json":"bg-green-500/20 text-green-400",".gz":"bg-amber-500/20 text-amber-400",".zip":"bg-purple-500/20 text-purple-400",".dtsx":"bg-pink-500/20 text-pink-400",".py":"bg-yellow-500/20 text-yellow-400",".sql":"bg-cyan-500/20 text-cyan-400"};function Bt(t){const s=t.lastIndexOf(".");return s>=0?t.slice(s).toLowerCase():""}function It(t){return t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(1)} MB`}function zt({onFile:t,accept:s,disabled:r}){const a=m.useRef(null),[l,o]=m.useState(!1),[n,i]=m.useState(null),d=m.useCallback(u=>{i(u),t(u)},[t]),c=m.useCallback(u=>{var f;u.preventDefault(),o(!1);const h=(f=u.dataTransfer.files)==null?void 0:f[0];h&&d(h)},[d]),x=m.useCallback(u=>{u.preventDefault(),o(!0)},[]),g=m.useCallback(()=>o(!1),[]),b=m.useCallback(u=>{var f;const h=(f=u.target.files)==null?void 0:f[0];h&&d(h)},[d]),p=n?Bt(n.name):"",j=Ot[p]||"bg-gray-500/20 text-gray-400";return e.jsxs("div",{onDrop:c,onDragOver:x,onDragLeave:g,onClick:()=>{var u;return!r&&((u=a.current)==null?void 0:u.click())},className:`
        relative cursor-pointer rounded-xl border-2 border-dashed p-8 text-center transition-all
        ${l?"border-primary bg-primary/5 scale-[1.01]":"border-border hover:border-gray-500"}
        ${r?"opacity-50 cursor-not-allowed":""}
      `,children:[e.jsx("input",{ref:a,type:"file",className:"hidden",accept:s,onChange:b,disabled:r}),n?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx("svg",{className:"w-8 h-8 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-lg font-medium text-gray-100",children:n.name}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-mono ${j}`,children:p})]}),e.jsx("p",{className:"text-sm text-gray-400",children:It(n.size)}),e.jsx("p",{className:"text-xs text-gray-500",children:"Click or drop another file to replace"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("svg",{className:"mx-auto w-12 h-12 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("p",{className:"text-gray-300 font-medium",children:"Drop your ETL flow file here"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Supports NiFi XML/JSON, SSIS .dtsx, Informatica XML, Airflow .py, SQL, and more"})]})]})}function Wt(t){return t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(1)} MB`}function De(){var i,d,c;const t=S(x=>x.parsed),s=S(x=>x.fileName),r=S(x=>x.fileSize),a=S(x=>x.platform),l=N(x=>x.stepStatuses[0]),{runAll:o}=B(),n=m.useCallback(x=>{o(x)},[o]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-100 flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center text-sm text-blue-400 font-mono",children:"1"}),"Parse Flow"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:"Upload your ETL flow definition file. The parser will auto-detect the platform and extract processors, connections, and process groups."})]}),e.jsx(zt,{onFile:n,disabled:l==="running"}),l==="running"&&e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-800/50 border border-border",children:[e.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-primary border-t-transparent animate-spin"}),e.jsxs("span",{className:"text-sm text-gray-300",children:["Parsing ",s,"..."]})]}),t&&l==="done"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[e.jsx(K,{label:"File",value:s||"Unknown"}),e.jsx(K,{label:"Size",value:Wt(r)}),e.jsx(K,{label:"Version",value:t.version||"Auto",badge:!0}),e.jsx(K,{label:"Platform",value:a||t.platform||"Unknown",badge:!0})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx(te,{label:"Processors",value:((i=t.processors)==null?void 0:i.length)??0,color:"text-blue-400"}),e.jsx(te,{label:"Connections",value:((d=t.connections)==null?void 0:d.length)??0,color:"text-purple-400"}),e.jsx(te,{label:"Process Groups",value:((c=t.processGroups)==null?void 0:c.length)??0,color:"text-cyan-400"})]}),t.warnings&&t.warnings.length>0&&e.jsxs("div",{className:"rounded-lg border border-amber-500/30 bg-amber-500/5 p-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-amber-400 mb-2",children:["Parse Warnings (",t.warnings.length,")"]}),e.jsx("ul",{className:"space-y-1",children:t.warnings.map((x,g)=>e.jsxs("li",{className:"text-xs text-amber-300/70 flex items-start gap-2",children:[e.jsx("span",{className:"text-amber-500 mt-0.5",children:"⚠"}),x.message]},g))})]})]})]})}function K({label:t,value:s,badge:r}){return e.jsxs("div",{className:"rounded-lg bg-gray-800/50 border border-border p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:t}),r?e.jsx("span",{className:"px-2 py-0.5 rounded bg-primary/10 text-primary text-sm font-medium",children:s}):e.jsx("p",{className:"text-sm text-gray-200 truncate",children:s})]})}function te({label:t,value:s,color:r}){return e.jsxs("div",{className:"rounded-lg bg-gray-800/50 border border-border p-4 text-center",children:[e.jsx("p",{className:`text-2xl font-bold ${r}`,children:s}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:t})]})}const Ut=[[/^(Get|Consume|Listen|Fetch|Tail|List|Query|Scan|Select|Generate)/i,"source"],[/^(Put|Publish|Send|Post|Insert|Write|Delete|Store)/i,"sink"],[/^(Route|Distribute|Detect|Funnel)/i,"route"],[/^(Execute|Invoke|Handle)/i,"process"],[/^(Log|Debug|Count|Wait|Notify|Control|Monitor)/i,"utility"],[/Convert|Replace|Update|Jolt|Extract|Evaluate|Transform|Compress|Encrypt|Lookup|Validate|Split|Merge/i,"transform"]];function Vt(t){for(const[s,r]of Ut)if(s.test(t))return r;return"transform"}const _t=["source","transform","process","route","sink","utility"],O={source:{label:"TIER 1 — DATA SOURCES & INGESTION",color:"#3B82F6",bgAlpha:"rgba(59,130,246,0.08)",border:"#2563EB"},transform:{label:"TIER 2 — TRANSFORMATIONS & ENRICHMENT",color:"#22C55E",bgAlpha:"rgba(34,197,94,0.06)",border:"#16A34A"},process:{label:"TIER 3 — EXECUTION & PROCESSING",color:"#A855F7",bgAlpha:"rgba(168,85,247,0.08)",border:"#9333EA"},route:{label:"TIER 4 — ROUTING & DISTRIBUTION",color:"#EAB308",bgAlpha:"rgba(234,179,8,0.08)",border:"#CA8A04"},sink:{label:"TIER 5 — DATA SINKS & OUTPUT",color:"#EF4444",bgAlpha:"rgba(239,68,68,0.08)",border:"#DC2626"},utility:{label:"TIER 6 — UTILITIES & MONITORING",color:"#6B7280",bgAlpha:"rgba(107,114,128,0.06)",border:"#4B5563"}};function fe(t){return t>=.9?"#22C55E":t>=.7?"#F59E0B":t>0?"#EF4444":"#475569"}function Gt({node:t,isHovered:s,isSelected:r,isDimmed:a,onHover:l,onClick:o}){const n=O[t.role]||O.transform,i=r?"#fff":s?n.color:`${n.border}88`;return e.jsxs("div",{onMouseEnter:()=>l(t.id),onMouseLeave:()=>l(null),onClick:()=>o(t.id),style:{background:s||r?"rgba(255,255,255,0.06)":"rgba(0,0,0,0.3)",border:`${r?2:1}px solid ${i}`,borderRadius:6,padding:"6px 10px",cursor:"pointer",minWidth:130,maxWidth:200,transition:"all 0.15s",opacity:a?.25:1},children:[e.jsx("div",{style:{fontSize:10,fontWeight:700,color:"#E2E8F0",fontFamily:"'JetBrains Mono', monospace",lineHeight:1.2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),e.jsxs("div",{style:{display:"flex",gap:4,marginTop:4,flexWrap:"wrap",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:8,padding:"1px 5px",borderRadius:3,background:`${n.color}22`,color:n.color,fontWeight:600},children:t.type}),t.connCount>0&&e.jsxs("span",{style:{fontSize:8,padding:"1px 5px",borderRadius:3,background:"rgba(107,114,128,0.2)",color:"#9CA3AF"},children:[t.connCount," conn"]}),t.confidence>0&&e.jsxs("span",{style:{fontSize:8,padding:"1px 5px",borderRadius:3,background:`${fe(t.confidence)}22`,color:fe(t.confidence),fontWeight:600},children:[Math.round(t.confidence*100),"%"]}),!t.mapped&&t.confidence===0&&e.jsx("span",{style:{fontSize:7,padding:"1px 4px",borderRadius:3,background:"rgba(239,68,68,0.15)",color:"#EF4444",fontWeight:700,textTransform:"uppercase"},children:"unmapped"})]}),t.group!=="(root)"&&e.jsx("div",{style:{fontSize:7,color:"#475569",marginTop:2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.group})]})}function Ht({group:t,count:s,expanded:r,onToggle:a,color:l}){return e.jsxs("button",{onClick:a,style:{display:"flex",alignItems:"center",gap:6,background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.04)",borderRadius:4,cursor:"pointer",padding:"4px 8px",marginBottom:4},children:[e.jsx("span",{style:{fontSize:10,color:"#64748B",transform:r?"rotate(90deg)":"rotate(0)",transition:"transform 0.15s",display:"inline-block"},children:"▶"}),e.jsx("span",{style:{fontSize:10,fontWeight:700,color:l,letterSpacing:"0.02em",fontFamily:"'JetBrains Mono', monospace"},children:t}),e.jsx("span",{style:{fontSize:9,color:"#64748B",background:"rgba(255,255,255,0.05)",padding:"0 5px",borderRadius:8,fontWeight:600},children:s})]})}function Yt({nodeId:t,nodes:s,connections:r}){if(!t)return e.jsx("div",{style:{padding:20,color:"#64748B",textAlign:"center",fontSize:12},children:"Click any processor to see its dependencies"});const a=s.find(i=>i.id===t);if(!a)return null;const l=r.filter(i=>i.sourceName===t),o=r.filter(i=>i.destinationName===t),n=O[a.role]||O.transform;return e.jsxs("div",{style:{padding:14},children:[e.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#E2E8F0",marginBottom:2,fontFamily:"'JetBrains Mono', monospace"},children:a.name}),e.jsxs("div",{style:{fontSize:9,color:"#64748B",marginBottom:8},children:[a.type," | ",a.group," | ",e.jsx("span",{style:{color:n.color},children:a.role})]}),l.length>0&&e.jsxs("div",{style:{marginBottom:10},children:[e.jsxs("div",{style:{fontSize:9,fontWeight:700,color:"#94A3B8",textTransform:"uppercase",letterSpacing:"0.1em",marginBottom:4},children:["OUTPUTS (",l.length,")"]}),l.slice(0,20).map((i,d)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,marginBottom:3},children:[e.jsx("div",{style:{width:6,height:2,borderRadius:1,background:"#22C55E",flexShrink:0}}),e.jsx("span",{style:{fontSize:9,color:"#CBD5E1",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:i.destinationName}),e.jsxs("span",{style:{fontSize:8,color:"#475569",flexShrink:0},children:["(",i.relationship,")"]})]},d)),l.length>20&&e.jsxs("div",{style:{fontSize:8,color:"#475569"},children:["...and ",l.length-20," more"]})]}),o.length>0&&e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:9,fontWeight:700,color:"#94A3B8",textTransform:"uppercase",letterSpacing:"0.1em",marginBottom:4},children:["INPUTS (",o.length,")"]}),o.slice(0,20).map((i,d)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,marginBottom:3},children:[e.jsx("div",{style:{width:6,height:2,borderRadius:1,background:"#3B82F6",flexShrink:0}}),e.jsx("span",{style:{fontSize:9,color:"#CBD5E1",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:i.sourceName}),e.jsxs("span",{style:{fontSize:8,color:"#475569",flexShrink:0},children:["(",i.relationship,")"]})]},d)),o.length>20&&e.jsxs("div",{style:{fontSize:8,color:"#475569"},children:["...and ",o.length-20," more"]})]})]})}function Pe({processors:t,connections:s,mappings:r}){const[a,l]=m.useState(null),[o,n]=m.useState(null),[i,d]=m.useState(new Set),[c,x]=m.useState("diagram"),g=m.useRef(null),b=m.useRef(null),p=m.useRef({}),[j,u]=m.useState([]),[h,f]=m.useState({w:0,h:0}),w=m.useMemo(()=>{const y={};s.forEach(v=>{y[v.sourceName]=(y[v.sourceName]||0)+1,y[v.destinationName]=(y[v.destinationName]||0)+1});const k={};if(r)for(const v of r)k[v.name]={role:v.role,category:v.category,mapped:v.mapped,confidence:v.confidence};return t.map(v=>{const E=k[v.name];return{id:v.name,name:v.name,type:v.type,group:v.group||"(root)",role:(E==null?void 0:E.role)||Vt(v.type),category:(E==null?void 0:E.category)||"",connCount:y[v.name]||0,mapped:(E==null?void 0:E.mapped)??!0,confidence:(E==null?void 0:E.confidence)??0}})},[t,s,r]),C=m.useMemo(()=>_t.map(y=>{const k=w.filter(R=>R.role===y),v=new Map;k.forEach(R=>{const D=R.category||R.type,P=v.get(D)||[];P.push(R),v.set(D,P)});const E=Array.from(v.entries()).sort((R,D)=>D[1].length-R[1].length);return{role:y,config:O[y],groups:E,totalCount:k.length}}).filter(y=>y.totalCount>0),[w]);m.useEffect(()=>{const y=new Set;C.forEach(k=>{k.groups.forEach(([v,E])=>{E.length<=12&&y.add(`${k.role}:${v}`)})}),d(y)},[C]);const L=m.useMemo(()=>{const y=a||o;if(!y)return null;const k=new Set;return k.add(y),s.forEach(v=>{v.sourceName===y&&k.add(v.destinationName),v.destinationName===y&&k.add(v.sourceName)}),k},[a,o,s]),M=m.useCallback(y=>{d(k=>{const v=new Set(k);return v.has(y)?v.delete(y):v.add(y),v})},[]),$=m.useCallback(y=>{n(k=>k===y?null:y)},[]),I=m.useCallback((y,k)=>{p.current[y]=k},[]),z=m.useCallback(()=>{const y=b.current;if(!y||c!=="diagram")return;const k=y.getBoundingClientRect();f({w:y.scrollWidth,h:y.scrollHeight});const v=a||o,E=s.map(R=>{const D=p.current[R.sourceName],P=p.current[R.destinationName];if(!D||!P)return null;const W=D.getBoundingClientRect(),X=P.getBoundingClientRect(),Oe=W.left+W.width/2-k.left,Be=W.top+W.height-k.top,Ie=X.left+X.width/2-k.left,ze=X.top-k.top,H=v?R.sourceName===v||R.destinationName===v:!1,We=v?!H:!1,Ue=R.relationship==="failure"?"#EF4444":H?"#60A5FA":"#334155";return{fromX:Oe,fromY:Be,toX:Ie,toY:ze,color:Ue,thickness:H?2:1,isActive:H,isDimmed:We}}).filter(Boolean);u(E)},[a,o,s,c]);m.useEffect(()=>{if(c!=="diagram")return;const y=setTimeout(z,150);return()=>clearTimeout(y)},[z,i]),m.useEffect(()=>{const y=g.current;if(!y||c!=="diagram")return;const k=()=>{(a||o)&&z()};return y.addEventListener("scroll",k,{passive:!0}),()=>y.removeEventListener("scroll",k)},[z,a,o,c]);const A=m.useMemo(()=>{const y={};w.forEach(v=>{y[v.role]=(y[v.role]||0)+1});const k=new Set(w.map(v=>v.group)).size;return{total:w.length,connections:s.length,roles:y,groups:k}},[w,s]);return!t||t.length===0?e.jsx("div",{className:"rounded-lg border border-border bg-gray-800/30 p-8 text-center text-gray-500 text-sm",children:"No processors to visualize"}):e.jsxs("div",{style:{background:"#0A0F1A",borderRadius:12,border:"1px solid #1E293B",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid #1E293B",display:"flex",alignItems:"center",justifyContent:"space-between",background:"rgba(15,23,42,0.9)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{fontSize:13,fontWeight:800,color:"#E2E8F0",letterSpacing:"-0.02em"},children:"Flow Architecture"}),e.jsx("div",{style:{display:"flex",gap:2},children:[["diagram","Tier Diagram","▤"],["matrix","Connection Matrix","⊞"]].map(([y,k,v])=>e.jsxs("button",{onClick:()=>x(y),style:{padding:"4px 12px",borderRadius:6,border:"none",cursor:"pointer",fontSize:10,fontWeight:600,background:c===y?"rgba(59,130,246,0.2)":"transparent",color:c===y?"#60A5FA":"#64748B"},children:[v," ",k]},y))})]}),e.jsx("div",{style:{display:"flex",gap:10,fontSize:9},children:Object.entries(O).map(([y,k])=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:3},children:[e.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:k.color}}),e.jsx("span",{style:{color:"#94A3B8",textTransform:"capitalize"},children:y})]},y))})]}),e.jsxs("div",{style:{padding:"5px 16px",borderBottom:"1px solid #1E293B",display:"flex",gap:16,fontSize:10,color:"#64748B"},children:[e.jsxs("span",{children:[e.jsx("strong",{style:{color:"#E2E8F0"},children:A.total})," Processors"]}),e.jsxs("span",{children:[e.jsx("strong",{style:{color:"#E2E8F0"},children:A.connections})," Connections"]}),e.jsxs("span",{children:[e.jsx("strong",{style:{color:"#E2E8F0"},children:A.groups})," Process Groups"]}),Object.entries(A.roles).map(([y,k])=>{var v;return e.jsxs("span",{style:{color:((v=O[y])==null?void 0:v.color)||"#64748B"},children:[e.jsx("strong",{children:k})," ",y]},y)})]}),e.jsxs("div",{style:{display:"flex",maxHeight:"calc(100vh - 200px)",minHeight:500,overflow:"hidden"},children:[e.jsx("div",{ref:g,style:{flex:1,overflowY:"auto",overflowX:"auto",position:"relative"},children:c==="diagram"?e.jsxs("div",{ref:b,style:{position:"relative",padding:"16px 20px",minWidth:800},children:[e.jsxs("svg",{style:{position:"absolute",top:0,left:0,width:h.w||"100%",height:h.h||"100%",pointerEvents:"none",zIndex:1},children:[e.jsxs("defs",{children:[e.jsx("marker",{id:"tier-arrow",viewBox:"0 0 10 6",refX:"10",refY:"3",markerWidth:"7",markerHeight:"5",orient:"auto",children:e.jsx("path",{d:"M0,0 L10,3 L0,6",fill:"#475569"})}),e.jsx("marker",{id:"tier-arrow-active",viewBox:"0 0 10 6",refX:"10",refY:"3",markerWidth:"7",markerHeight:"5",orient:"auto",children:e.jsx("path",{d:"M0,0 L10,3 L0,6",fill:"#60A5FA"})})]}),j.map((y,k)=>{const v=(y.fromY+y.toY)/2,E=y.toX-y.fromX,R=Math.min(Math.abs(E)*.3,50),D=`M${y.fromX},${y.fromY} C${y.fromX},${v-R} ${y.toX},${v+R} ${y.toX},${y.toY}`;return e.jsx("path",{d:D,fill:"none",stroke:y.color,strokeWidth:y.thickness,opacity:y.isDimmed?.06:y.isActive?.9:.2,markerEnd:y.isActive?"url(#tier-arrow-active)":"url(#tier-arrow)",style:{transition:"opacity 0.2s"}},k)})]}),C.map(y=>{const k=y.config;return e.jsxs("div",{style:{background:k.bgAlpha,border:`1px solid ${k.border}33`,borderRadius:10,padding:"12px 16px",marginBottom:10,position:"relative",zIndex:2},children:[e.jsxs("div",{style:{fontSize:10,fontWeight:800,color:k.color,textTransform:"uppercase",letterSpacing:"0.08em",marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx("div",{style:{width:3,height:14,borderRadius:2,background:k.color}}),k.label,e.jsxs("span",{style:{fontSize:9,color:"#475569",fontWeight:500,letterSpacing:0},children:["(",y.totalCount," processors)"]})]}),y.groups.map(([v,E])=>{const R=`${y.role}:${v}`,D=i.has(R);return e.jsxs("div",{style:{marginBottom:6},children:[y.groups.length>1&&e.jsx(Ht,{group:v,count:E.length,expanded:D,onToggle:()=>M(R),color:k.color}),(D||y.groups.length===1)&&e.jsx("div",{style:{display:"flex",gap:6,flexWrap:"wrap",paddingLeft:y.groups.length>1?12:0},children:E.map(P=>e.jsx("div",{ref:W=>I(P.id,W),children:e.jsx(Gt,{node:P,isHovered:a===P.id,isSelected:o===P.id,isDimmed:L!==null&&!L.has(P.id),onHover:l,onClick:$})},P.id))}),!D&&y.groups.length>1&&e.jsxs("div",{style:{fontSize:9,color:"#475569",paddingLeft:12},children:[E.length," processors collapsed — click to expand"]})]},R)})]},y.role)})]}):e.jsxs("div",{style:{padding:16},children:[e.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#E2E8F0",marginBottom:4},children:"Connection Matrix"}),e.jsx("div",{style:{fontSize:10,color:"#64748B",marginBottom:12},children:"Top 30 most-connected processors — hover to highlight relationships"}),e.jsx(Kt,{nodes:w,connections:s,hoveredNode:a,onHover:l})]})}),e.jsxs("div",{style:{width:260,borderLeft:"1px solid #1E293B",background:"rgba(15,23,42,0.6)",overflowY:"auto",flexShrink:0},children:[e.jsx("div",{style:{padding:"10px 14px",borderBottom:"1px solid #1E293B"},children:e.jsx("div",{style:{fontSize:10,fontWeight:700,color:"#64748B",textTransform:"uppercase",letterSpacing:"0.1em"},children:"Dependencies"})}),e.jsx(Yt,{nodeId:o,nodes:w,connections:s}),e.jsxs("div",{style:{padding:"10px 14px",borderTop:"1px solid #1E293B"},children:[e.jsx("div",{style:{fontSize:9,fontWeight:700,color:"#64748B",textTransform:"uppercase",letterSpacing:"0.1em",marginBottom:6},children:"Top Connected"}),[...w].sort((y,k)=>k.connCount-y.connCount).slice(0,15).map((y,k,v)=>{var D;const E=((D=v[0])==null?void 0:D.connCount)||1,R=y.connCount>6?"#EF4444":y.connCount>3?"#F59E0B":"#3B82F6";return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,marginBottom:3,cursor:"pointer"},onClick:()=>$(y.id),onMouseEnter:()=>l(y.id),onMouseLeave:()=>l(null),children:[e.jsx("div",{style:{fontSize:8,color:"#64748B",width:14,textAlign:"right",fontFamily:"monospace"},children:y.connCount}),e.jsx("div",{style:{flex:1,height:4,borderRadius:2,background:"#1E293B",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",borderRadius:2,background:R,width:`${y.connCount/E*100}%`,transition:"width 0.3s"}})}),e.jsx("div",{style:{fontSize:8,color:"#94A3B8",fontFamily:"monospace",minWidth:60,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:y.name.length>14?y.name.slice(0,12)+"..":y.name})]},y.id)})]})]})]})]})}function Kt({nodes:t,connections:s,hoveredNode:r,onHover:a}){const l=m.useMemo(()=>[...t].sort((n,i)=>i.connCount-n.connCount).slice(0,30),[t]),o=m.useMemo(()=>{const n=new Set;return s.forEach(i=>{n.add(`${i.sourceName}|${i.destinationName}`)}),n},[s]);return e.jsx("div",{style:{overflowX:"auto",overflowY:"auto",maxHeight:500},children:e.jsxs("table",{style:{borderCollapse:"collapse",fontSize:8,fontFamily:"'JetBrains Mono', monospace"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{padding:"3px 6px",background:"#1E293B",color:"#64748B",position:"sticky",left:0,zIndex:2,textAlign:"left",borderBottom:"1px solid #334155",fontSize:8},children:"Source / Dest"}),l.map(n=>e.jsx("th",{onMouseEnter:()=>a(n.id),onMouseLeave:()=>a(null),style:{padding:"2px 3px",background:r===n.id?"rgba(255,255,255,0.1)":"#1E293B",color:r===n.id?"#fff":"#94A3B8",cursor:"pointer",writingMode:"vertical-lr",textOrientation:"mixed",minWidth:20,borderBottom:"1px solid #334155",borderRight:"1px solid #1a1f2e",fontWeight:500,maxHeight:80},children:n.name.length>12?n.name.slice(0,10)+"..":n.name},n.id))]})}),e.jsx("tbody",{children:l.map(n=>{var i;return e.jsxs("tr",{children:[e.jsx("td",{onMouseEnter:()=>a(n.id),onMouseLeave:()=>a(null),style:{padding:"4px 6px",background:r===n.id?"rgba(255,255,255,0.1)":"#111827",color:r===n.id?"#fff":((i=O[n.role])==null?void 0:i.color)||"#94A3B8",position:"sticky",left:0,zIndex:1,cursor:"pointer",borderBottom:"1px solid #1a1f2e",fontWeight:600,whiteSpace:"nowrap",maxWidth:120,overflow:"hidden",textOverflow:"ellipsis"},children:n.name.length>18?n.name.slice(0,16)+"..":n.name}),l.map(d=>{const c=o.has(`${n.id}|${d.id}`),x=o.has(`${d.id}|${n.id}`),g=r===n.id||r===d.id;return e.jsxs("td",{style:{padding:2,background:c||x?g?"rgba(255,255,255,0.15)":"rgba(59,130,246,0.15)":g?"rgba(255,255,255,0.03)":"transparent",borderBottom:"1px solid #1a1f2e",borderRight:"1px solid #1a1f2e",textAlign:"center",verticalAlign:"middle"},children:[c&&e.jsx("div",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:14,height:12,borderRadius:2,fontSize:7,fontWeight:800,background:"rgba(59,130,246,0.3)",color:"#60A5FA",border:"1px solid rgba(59,130,246,0.5)"},children:"→"}),x&&e.jsx("div",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:14,height:12,borderRadius:2,fontSize:7,fontWeight:800,background:"rgba(168,85,247,0.3)",color:"#A855F7",border:"1px solid rgba(168,85,247,0.5)"},children:"←"})]},d.id)})]},n.id)})})]})})}const Jt=["all","source","transform","process","route","sink","utility"];function qt(t,s){const[r,a]=m.useState(""),[l,o]=m.useState("all"),[n,i]=m.useState(0),[d,c]=m.useState(100),x=m.useMemo(()=>{const u=new Map;return s==null||s.forEach(h=>u.set(h.name,h)),u},[s]),{matchedNames:g,matchCount:b}=m.useMemo(()=>{const u=r.toLowerCase(),h=new Set;return t.forEach(f=>{const w=x.get(f.name);if(!(u&&!`${f.name} ${f.type} ${f.group}`.toLowerCase().includes(u))&&!(l!=="all"&&w&&w.role!==l)){if(w){const C=w.confidence<=1?w.confidence*100:w.confidence;if(C<n||C>d)return}h.add(f.name)}}),{matchedNames:h,matchCount:h.size}},[t,x,r,l,n,d]),p=m.useCallback((u,h)=>{i(u),c(h)},[]),j=m.useCallback(()=>{a(""),o("all"),i(0),c(100)},[]);return{query:r,setQuery:a,role:l,setRole:o,confidenceMin:n,confidenceMax:d,setConfidenceRange:p,matchCount:b,matchedNames:g,reset:j}}function Qt({processors:t,mappings:s,onFilterChange:r}){const a=qt(t,s),l=m.useRef(a.matchedNames);m.useEffect(()=>{l.current!==a.matchedNames&&(l.current=a.matchedNames,r==null||r(a.matchedNames))},[a.matchedNames,r]);const o=a.query||a.role!=="all"||a.confidenceMin>0||a.confidenceMax<100;return e.jsxs("div",{className:"flex items-center gap-3 flex-wrap rounded-lg bg-gray-800/50 border border-border px-4 py-3 mb-4",children:[e.jsx("div",{className:"relative flex-1 min-w-[200px]",children:e.jsx("input",{type:"text",placeholder:"Search processors by name, type, or group...",value:a.query,onChange:n=>a.setQuery(n.target.value),className:"w-full px-3 py-1.5 rounded-lg bg-gray-900 border border-border text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:border-gray-600"})}),e.jsx("select",{value:a.role,onChange:n=>a.setRole(n.target.value),className:"px-2 py-1.5 rounded-lg bg-gray-900 border border-border text-sm text-gray-300 focus:outline-none",children:Jt.map(n=>e.jsx("option",{value:n,children:n==="all"?"All Roles":n.charAt(0).toUpperCase()+n.slice(1)},n))}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[e.jsx("span",{children:"Conf:"}),e.jsx("input",{type:"number",min:0,max:100,step:10,value:a.confidenceMin,onChange:n=>a.setConfidenceRange(Number(n.target.value),a.confidenceMax),className:"w-14 px-1.5 py-1 rounded bg-gray-900 border border-border text-sm text-gray-300 text-center"}),e.jsx("span",{children:"-"}),e.jsx("input",{type:"number",min:0,max:100,step:10,value:a.confidenceMax,onChange:n=>a.setConfidenceRange(a.confidenceMin,Number(n.target.value)),className:"w-14 px-1.5 py-1 rounded bg-gray-900 border border-border text-sm text-gray-300 text-center"}),e.jsx("span",{children:"%"})]}),e.jsxs("span",{className:"text-xs text-gray-500 tabular-nums whitespace-nowrap",children:[a.matchCount," match",a.matchCount!==1?"es":""]}),o&&e.jsx("button",{onClick:a.reset,className:"text-xs text-gray-500 hover:text-gray-300 transition",children:"Clear"})]})}const V=[{label:"High (90-100%)",min:90,max:100,color:"text-green-400",bgColor:"bg-green-500/40"},{label:"Medium (70-89%)",min:70,max:89,color:"text-amber-400",bgColor:"bg-amber-500/40"},{label:"Low (50-69%)",min:50,max:69,color:"text-orange-400",bgColor:"bg-orange-500/40"},{label:"Very Low (<50%)",min:0,max:49,color:"text-red-400",bgColor:"bg-red-500/40"}];function oe({onBinClick:t}){const s=S(o=>o.assessment),r=m.useMemo(()=>{const o=V.map(()=>0);return s==null||s.mappings.forEach(n=>{const i=n.confidence<=1?n.confidence*100:n.confidence;for(let d=0;d<V.length;d++)if(i>=V[d].min&&i<=V[d].max){o[d]++;break}}),o},[s]),a=m.useMemo(()=>r.reduce((o,n)=>o+n,0),[r]),l=m.useMemo(()=>Math.max(...r,1),[r]);return!s||a===0?e.jsx("div",{className:"rounded-lg border border-border bg-gray-800/30 p-6 text-center text-gray-500 text-sm",children:"No confidence data. Run Step 3 (Assess) first."}):e.jsxs("div",{className:"rounded-lg border border-border bg-gray-900/50 p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Confidence Distribution"}),e.jsx("div",{className:"space-y-2",children:V.map((o,n)=>{const i=r[n],d=a>0?Math.round(i/a*100):0,c=Math.max(i/l*100,2);return e.jsxs("div",{className:"group cursor-pointer",onClick:()=>t==null?void 0:t(o.min,o.max),children:[e.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[e.jsx("span",{className:`text-xs font-medium ${o.color}`,children:o.label}),e.jsxs("span",{className:"text-xs text-gray-500 tabular-nums",children:[i," (",d,"%)"]})]}),e.jsx("div",{className:"h-5 bg-gray-800/50 rounded overflow-hidden",children:e.jsx("div",{className:`h-full rounded ${o.bgColor} group-hover:opacity-80 transition-all duration-300`,style:{width:`${c}%`}})})]},o.label)})})]})}const se={critical:{bg:"bg-red-500/30",border:"border-red-500/40",text:"text-red-300"},high:{bg:"bg-orange-500/30",border:"border-orange-500/40",text:"text-orange-300"},medium:{bg:"bg-yellow-500/30",border:"border-yellow-500/40",text:"text-yellow-300"},low:{bg:"bg-green-500/30",border:"border-green-500/40",text:"text-green-300"}};function le(){const t=S(n=>n.analysis),[s,r]=m.useState(null),a=m.useMemo(()=>{var i;if(!((i=t==null?void 0:t.securityFindings)!=null&&i.length))return[];const n=new Map;return t.securityFindings.forEach(d=>{const c=d,x=String(c.type??c.category??"Unknown"),g=String(c.severity??"medium").toLowerCase();n.has(x)||n.set(x,{category:x,severity:g,count:0,findings:[]});const b=n.get(x);b.count++,b.findings.push(c);const p=["critical","high","medium","low"];p.indexOf(g)<p.indexOf(b.severity)&&(b.severity=g)}),[...n.values()].sort((d,c)=>c.count-d.count)},[t]),l=m.useMemo(()=>a.reduce((n,i)=>n+i.count,0),[a]);if(a.length===0)return e.jsx("div",{className:"rounded-lg border border-border bg-gray-800/30 p-6 text-center text-gray-500 text-sm",children:"No security findings. Run Step 2 (Analyze) first."});const o=Math.max(...a.map(n=>n.count));return e.jsxs("div",{className:"rounded-lg border border-border bg-gray-900/50 p-4",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:["Security Findings (",l,")"]}),e.jsx("div",{className:"grid grid-cols-4 gap-1.5 auto-rows-min",children:a.map(n=>{const i=se[n.severity]??se.medium,d=n.count===o?2:1,c=s===n.category;return e.jsxs("div",{className:`rounded-lg border ${i.border} ${i.bg} p-3 cursor-pointer transition hover:opacity-80
                ${c?"col-span-4":d===2?"col-span-2":"col-span-1"}`,onClick:()=>r(c?null:n.category),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-xs font-medium ${i.text} truncate`,children:n.category}),e.jsx("span",{className:`text-[10px] font-bold ${i.text} tabular-nums`,children:n.count})]}),e.jsx("span",{className:`text-[10px] ${i.text} opacity-70 capitalize`,children:n.severity}),c&&e.jsx("div",{className:"mt-2 pt-2 border-t border-white/10 space-y-1.5",children:n.findings.map((x,g)=>e.jsxs("div",{className:"text-[10px] text-gray-300 bg-gray-900/40 rounded px-2 py-1.5",children:[e.jsxs("span",{className:"font-medium",children:[String(x.processor??"Unknown"),": "]}),String(x.finding??x.description??"")]},g))})]},n.category)})}),e.jsx("div",{className:"flex items-center gap-3 mt-3 text-[10px] text-gray-500",children:Object.entries(se).map(([n,i])=>e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:`w-3 h-3 rounded ${i.bg} border ${i.border}`}),n.charAt(0).toUpperCase()+n.slice(1)]},n))})]})}function Xt(){var n;const t=S(i=>i.parsed),s=S(i=>i.analysis),r=N(i=>i.stepStatuses[1]),{runAnalyze:a}=B(),l=(((n=s==null?void 0:s.cycles)==null?void 0:n.length)??0)>0,o=Object.keys((s==null?void 0:s.dependencyGraph)??{}).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-100 flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center text-sm text-purple-400 font-mono",children:"2"}),"Analyze Flow"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:"Structural analysis of the parsed flow: dependency graph, external system detection, cycle detection, and security findings."})]}),e.jsx("button",{onClick:()=>a(),disabled:!t||r==="running",className:`px-4 py-2 rounded-lg bg-primary text-white text-sm font-medium
            hover:bg-primary/80 disabled:opacity-40 disabled:cursor-not-allowed transition`,children:r==="running"?"Analyzing...":"Run Analysis"})]}),!t&&e.jsx("div",{className:"rounded-lg border border-border bg-gray-800/30 p-8 text-center text-gray-500 text-sm",children:"Parse a flow file first (Step 1)"}),r==="running"&&e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-800/50 border border-border",children:[e.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-purple-400 border-t-transparent animate-spin"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Running structural analysis..."})]}),s&&r==="done"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[e.jsx(J,{label:"Graph Nodes",value:o,color:"text-blue-400"}),e.jsx(J,{label:"External Systems",value:s.externalSystems.length,color:"text-purple-400"}),e.jsx(J,{label:"Stages",value:s.stages.length,color:"text-cyan-400"}),e.jsx(J,{label:"Security Findings",value:s.securityFindings.length,color:"text-amber-400"})]}),t&&t.processors.length>0&&e.jsxs("div",{children:[e.jsx(Qt,{processors:t.processors}),e.jsx(Pe,{processors:t.processors,connections:t.connections})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(oe,{}),e.jsx(le,{})]}),e.jsx("div",{className:`rounded-lg border p-3 ${l?"border-red-500/30 bg-red-500/5":"border-green-500/30 bg-green-500/5"}`,children:e.jsx("span",{className:`text-sm font-medium ${l?"text-red-400":"text-green-400"}`,children:l?`${s.cycles.length} cycle(s) detected in flow graph`:"No cycles detected -- DAG structure confirmed"})}),s.externalSystems&&s.externalSystems.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"External Systems"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:s.externalSystems.map((i,d)=>{const c=String(i.name??`System ${d+1}`),x=String(i.type??"unknown");return e.jsxs("div",{className:"rounded-lg border border-border bg-gray-800/30 p-3 flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded bg-amber-500/20 flex items-center justify-center text-amber-400 text-xs font-bold",children:x.slice(0,2).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-200",children:c}),e.jsx("p",{className:"text-xs text-gray-500",children:x})]})]},d)})})]}),s.flowMetrics&&Object.keys(s.flowMetrics).length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Flow Metrics"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:Object.entries(s.flowMetrics).map(([i,d])=>e.jsxs("div",{className:"rounded-lg bg-gray-800/50 border border-border p-3 text-center",children:[e.jsx("p",{className:"text-lg font-bold text-gray-200 tabular-nums",children:String(d)}),e.jsx("p",{className:"text-xs text-gray-500 capitalize mt-0.5",children:i.replace(/_/g," ")})]},i))})]}),s.securityFindings&&s.securityFindings.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Security Findings"}),e.jsx("div",{className:"space-y-3",children:s.securityFindings.map((i,d)=>{const c=i,x=String(c.severity??"MEDIUM").toUpperCase(),g=String(c.processor??"Unknown"),b=String(c.type??""),p=String(c.finding??c.description??""),j=c.snippet?String(c.snippet):null,u={CRITICAL:{border:"border-red-500/40",bg:"bg-red-500/5",badge:"bg-red-500/20 text-red-400",text:"text-red-300/80"},HIGH:{border:"border-orange-500/40",bg:"bg-orange-500/5",badge:"bg-orange-500/20 text-orange-400",text:"text-orange-300/80"},MEDIUM:{border:"border-amber-500/40",bg:"bg-amber-500/5",badge:"bg-amber-500/20 text-amber-400",text:"text-amber-300/80"}},h=u[x]??u.MEDIUM;return e.jsx("div",{className:`rounded-lg border ${h.border} ${h.bg} p-4`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:`shrink-0 px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wide ${h.badge}`,children:x}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-200",children:g}),b&&e.jsx("span",{className:"text-[10px] text-gray-500 font-mono",children:b})]}),p&&e.jsx("p",{className:`text-xs ${h.text} mb-2`,children:p}),j&&e.jsx("pre",{className:"text-[11px] text-gray-400 bg-gray-900/60 rounded px-3 py-2 overflow-x-auto font-mono leading-relaxed border border-gray-700/30",children:j})]})]})},d)})})]})]})]})}function J({label:t,value:s,color:r}){return e.jsxs("div",{className:"rounded-lg bg-gray-800/50 border border-border p-4 text-center",children:[e.jsx("p",{className:`text-2xl font-bold tabular-nums ${r}`,children:s}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:t})]})}const Zt=[[/^(Get|Consume|Listen|Fetch|Tail|List|Query|Scan|Select|Generate)/i,"source"],[/^(Put|Publish|Send|Post|Insert|Write|Delete|Store)/i,"sink"],[/^(Route|Distribute|Detect|Funnel)/i,"route"],[/^(Execute|Invoke|Handle)/i,"process"],[/^(Log|Debug|Count|Wait|Notify|Control|Monitor)/i,"utility"],[/Convert|Replace|Update|Jolt|Extract|Evaluate|Transform|Compress|Encrypt|Lookup|Validate|Split|Merge/i,"transform"]];function es(t){for(const[s,r]of Zt)if(s.test(t))return r;return"transform"}function ts(t){return t<=1?Math.round(t*100):Math.round(t)}const ye=["source","transform","process","route","sink","utility"];function ss(t){return t>=90?"bg-green-500/40 text-green-300":t>=70?"bg-yellow-500/40 text-yellow-300":t>0?"bg-red-500/40 text-red-300":"bg-gray-800/30 text-gray-600"}function ie({onCellClick:t}){const s=S(d=>d.parsed),r=S(d=>d.assessment),[a,l]=m.useState(null),{groups:o,grid:n,truncated:i}=m.useMemo(()=>{const d=new Map;r==null||r.mappings.forEach(j=>d.set(j.name,{role:j.role,confidence:j.confidence}));const c=new Set;s==null||s.processors.forEach(j=>c.add(j.group||"Default"));const x=[...c],g=x.length>20,b=x.slice(0,20),p=new Map;return b.forEach(j=>{const u=new Map;ye.forEach(h=>u.set(h,{sum:0,count:0})),p.set(j,u)}),s==null||s.processors.forEach(j=>{var L;const u=j.group||"Default";if(!p.has(u))return;const h=d.get(j.name),f=(h==null?void 0:h.role)??es(j.type),w=h?ts(h.confidence):0,C=(L=p.get(u))==null?void 0:L.get(f);C&&(C.sum+=w,C.count+=1)}),{groups:b,grid:p,truncated:g}},[s,r]);return!s||o.length===0?e.jsx("div",{className:"rounded-lg border border-border bg-gray-800/30 p-6 text-center text-gray-500 text-sm",children:"No data available for risk heatmap"}):e.jsxs("div",{className:"rounded-lg border border-border bg-gray-900/50 p-4 overflow-x-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300",children:"Risk Heatmap"}),i&&e.jsx("span",{className:"text-[10px] text-amber-400 bg-amber-500/10 rounded px-1.5 py-0.5",children:"(showing top 20)"})]}),e.jsxs("div",{className:"inline-grid gap-1",style:{gridTemplateColumns:`120px repeat(${o.length}, minmax(60px, 1fr))`},children:[e.jsx("div",{className:"text-xs text-gray-500"}),o.map(d=>e.jsx("div",{className:"text-[10px] text-gray-400 text-center truncate px-1",title:d,children:d.length>10?d.slice(0,9)+"..":d},d)),ye.map(d=>e.jsxs(ne.Fragment,{children:[e.jsx("div",{className:"text-xs text-gray-400 capitalize flex items-center",children:d}),o.map(c=>{var j;const x=(j=n.get(c))==null?void 0:j.get(d),g=x&&x.count>0?Math.round(x.sum/x.count):0,b=(x==null?void 0:x.count)??0,p=(a==null?void 0:a.group)===c&&(a==null?void 0:a.tier)===d;return e.jsxs("div",{className:`relative rounded text-center text-[10px] font-medium py-2 cursor-pointer transition
                    ${ss(b>0?g:-1)} ${p?"ring-1 ring-white/30":""}`,onClick:()=>t==null?void 0:t(c,d),onMouseEnter:()=>l({group:c,tier:d}),onMouseLeave:()=>l(null),title:`${c} / ${d}: ${b} processors, avg ${g}%`,children:[b>0?`${g}%`:"-",p&&b>0&&e.jsxs("div",{className:"absolute z-20 bottom-full left-1/2 -translate-x-1/2 mb-1 px-2 py-1 rounded bg-gray-800 border border-border text-[10px] text-gray-300 whitespace-nowrap shadow-lg pointer-events-none",children:[b," processor",b!==1?"s":"",", avg ",g,"%"]})]},`${c}-${d}`)})]},d))]}),e.jsxs("div",{className:"flex items-center gap-3 mt-3 text-[10px] text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-green-500/40"})," 90%+"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-yellow-500/40"})," 70-89%"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-red-500/40"})," <70%"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-gray-800/30 border border-border"})," Empty"]})]})]})}function rs(t){const s=t<=1?t*100:t;return s>=90?"text-green-400":s>=70?"text-amber-400":"text-red-400"}function as(t){return`${(t<=1?t*100:t).toFixed(0)}%`}function ns(){const t=S(p=>p.parsed),s=S(p=>p.analysis),r=S(p=>p.assessment),a=N(p=>p.stepStatuses[2]),{runAssess:l}=B(),[o,n]=m.useState("all"),[i,d]=m.useState(""),c=t&&s&&a!=="running",x=((r==null?void 0:r.mappings)||[]).filter(p=>!(o==="mapped"&&!p.mapped||o==="unmapped"&&p.mapped||i&&!p.name.toLowerCase().includes(i.toLowerCase())&&!p.type.toLowerCase().includes(i.toLowerCase()))),g=(r==null?void 0:r.mappings.filter(p=>p.mapped).length)??0,b=(r==null?void 0:r.mappings.length)??0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-100 flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-amber-500/20 flex items-center justify-center text-sm text-amber-400 font-mono",children:"3"}),"Assess & Map"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:"Map each processor to its Databricks equivalent with confidence scoring."})]}),e.jsx("button",{onClick:()=>l(),disabled:!c,className:`px-4 py-2 rounded-lg bg-primary text-white text-sm font-medium
            hover:bg-primary/80 disabled:opacity-40 disabled:cursor-not-allowed transition`,children:a==="running"?"Assessing...":"Run Assessment"})]}),!t||!s?e.jsx("div",{className:"rounded-lg border border-border bg-gray-800/30 p-8 text-center text-gray-500 text-sm",children:"Complete Steps 1 and 2 first"}):a==="running"?e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-800/50 border border-border",children:[e.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-amber-400 border-t-transparent animate-spin"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Mapping processors to Databricks equivalents..."})]}):r&&a==="done"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[e.jsx(q,{label:"Total",value:String(b),color:"text-gray-400"}),e.jsx(q,{label:"Mapped",value:String(g),color:"text-green-400"}),e.jsx(q,{label:"Unmapped",value:String(r.unmappedCount),color:"text-red-400"}),e.jsx(q,{label:"Packages",value:String(r.packages.length),color:"text-blue-400"})]}),t&&t.processors.length>0&&e.jsx(Pe,{processors:t.processors,connections:t.connections,mappings:r.mappings}),e.jsx(ie,{}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx("input",{type:"text",placeholder:"Search processors...",value:i,onChange:p=>d(p.target.value),className:"px-3 py-1.5 rounded-lg bg-gray-800 border border-border text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:border-gray-600 w-56"}),e.jsx("div",{className:"flex gap-1",children:["all","mapped","unmapped"].map(p=>e.jsx("button",{onClick:()=>n(p),className:`px-2.5 py-1 rounded text-xs font-medium transition
                    ${o===p?"bg-primary/20 text-primary":"bg-gray-800 text-gray-400 hover:text-gray-200"}`,children:p.charAt(0).toUpperCase()+p.slice(1)},p))}),e.jsxs("span",{className:"text-xs text-gray-500 ml-auto",children:[x.length," processor(s)"]})]}),e.jsx("div",{className:"rounded-lg border border-border overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900/60 border-b border-border",children:[e.jsx("th",{className:"text-left px-4 py-2.5 text-xs font-medium text-gray-500 uppercase",children:"Processor"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-xs font-medium text-gray-500 uppercase",children:"Category"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-xs font-medium text-gray-500 uppercase",children:"Role"}),e.jsx("th",{className:"text-center px-4 py-2.5 text-xs font-medium text-gray-500 uppercase",children:"Confidence"}),e.jsx("th",{className:"text-center px-4 py-2.5 text-xs font-medium text-gray-500 uppercase",children:"Mapped"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-xs font-medium text-gray-500 uppercase",children:"Notes"})]})}),e.jsxs("tbody",{className:"divide-y divide-border",children:[x.map((p,j)=>e.jsxs("tr",{className:"hover:bg-gray-800/30 transition",children:[e.jsx("td",{className:"px-4 py-2.5 text-gray-200 font-medium",children:p.name}),e.jsx("td",{className:"px-4 py-2.5 text-gray-400 font-mono text-xs",children:p.type}),e.jsx("td",{className:"px-4 py-2.5 text-gray-400 text-xs",children:p.category||"—"}),e.jsx("td",{className:"px-4 py-2.5 text-gray-400",children:p.role}),e.jsx("td",{className:"px-4 py-2.5 text-center",children:e.jsx("span",{className:`font-medium tabular-nums ${rs(p.confidence)}`,children:as(p.confidence)})}),e.jsx("td",{className:"px-4 py-2.5 text-center",children:e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${p.mapped?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:p.mapped?"Yes":"No"})}),e.jsx("td",{className:"px-4 py-2.5 text-gray-300",children:p.notes})]},j)),x.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No matching processors"})})]})]})})})]}):null]})}function q({label:t,value:s,color:r}){return e.jsxs("div",{className:"rounded-lg bg-gray-800/50 border border-border p-3 text-center",children:[e.jsx("p",{className:`text-lg font-bold ${r}`,children:s}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:t})]})}function os({code:t,language:s="python",title:r,maxHeight:a="500px"}){const[l,o]=m.useState(!1),n=async()=>{await navigator.clipboard.writeText(t),o(!0),setTimeout(()=>o(!1),2e3)};return e.jsxs("div",{className:"rounded-lg border border-border bg-gray-950 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gray-900/60 border-b border-border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[r&&e.jsx("span",{className:"text-sm font-medium text-gray-300",children:r}),e.jsx("span",{className:"text-xs text-gray-500 bg-gray-800 px-2 py-0.5 rounded",children:s})]}),e.jsx("button",{onClick:n,className:"text-xs text-gray-400 hover:text-gray-200 flex items-center gap-1 px-2 py-1 rounded hover:bg-gray-800 transition",children:l?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy"]})})]}),e.jsx("div",{className:"overflow-auto",style:{maxHeight:a},children:e.jsx("pre",{className:"p-4 text-sm leading-relaxed",children:e.jsx("code",{className:"text-gray-300 whitespace-pre",children:t})})}),e.jsx("div",{className:"px-4 py-1 border-t border-border bg-gray-900/30",children:e.jsxs("span",{className:"text-xs text-gray-600",children:[t.split(`
`).length," lines"]})})]})}function ls(){const t=S(u=>u.parsed),s=S(u=>u.assessment),r=S(u=>u.notebook),a=N(u=>u.stepStatuses[3]),{runConvert:l}=B(),[o,n]=m.useState(0),i=t&&s&&a!=="running",d=()=>{if(!r)return;const u=JSON.stringify({nbformat:4,nbformat_minor:5,metadata:{kernelspec:{display_name:"Python 3",language:"python",name:"python3"}},cells:r.cells.map(C=>({cell_type:C.type,source:C.source.split(`
`),metadata:{},...C.type==="code"?{outputs:[],execution_count:null}:{}}))},null,2),h=new Blob([u],{type:"application/json"}),f=URL.createObjectURL(h),w=document.createElement("a");w.href=f,w.download="migration.ipynb",w.click(),URL.revokeObjectURL(f)},c=()=>{if(!r)return;const u=r.cells.filter(C=>C.type==="code").map(C=>C.source).join(`

# ──────────────────────────────────────

`),h=new Blob([u],{type:"text/plain"}),f=URL.createObjectURL(h),w=document.createElement("a");w.href=f,w.download="migration.py",w.click(),URL.revokeObjectURL(f)},[x,g]=m.useState(!1),[b,p]=m.useState(""),j=async()=>{if(!(!t||!s)){g(!0),p("");try{const u=await Re({parsed:t,assessment:s}),h=URL.createObjectURL(u),f=document.createElement("a");f.href=h,f.download="databricks_asset_bundle.zip",f.click(),URL.revokeObjectURL(h)}catch(u){console.error("DAB export failed:",u),p(u instanceof Error?u.message:"DAB export failed. Please try again.")}finally{g(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-100 flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-green-500/20 flex items-center justify-center text-sm text-green-400 font-mono",children:"4"}),"Convert to Databricks"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:"Generate a Databricks notebook with the converted ETL pipeline code."})]}),e.jsx("button",{onClick:()=>l(),disabled:!i,className:`px-4 py-2 rounded-lg bg-primary text-white text-sm font-medium
            hover:bg-primary/80 disabled:opacity-40 disabled:cursor-not-allowed transition`,children:a==="running"?"Generating...":"Generate Notebook"})]}),!t||!s?e.jsx("div",{className:"rounded-lg border border-border bg-gray-800/30 p-8 text-center text-gray-500 text-sm",children:"Complete Steps 1-3 first"}):a==="running"?e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-800/50 border border-border",children:[e.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-green-400 border-t-transparent animate-spin"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Generating Databricks notebook..."})]}):r&&a==="done"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-800/50 border border-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-500/20 flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-200",children:"migration_notebook"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[r.cells.length," cells -- python"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:d,className:"px-3 py-1.5 rounded-lg bg-gray-700 text-gray-200 text-xs hover:bg-gray-600 transition",children:"Download .ipynb"}),e.jsx("button",{onClick:c,className:"px-3 py-1.5 rounded-lg bg-gray-700 text-gray-200 text-xs hover:bg-gray-600 transition",children:"Download .py"}),e.jsxs("button",{onClick:j,disabled:x,className:"px-3 py-1.5 rounded-lg bg-orange-600/80 text-white text-xs hover:bg-orange-500 disabled:opacity-40 transition flex items-center gap-1.5",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),x?"Exporting...":"Export DAB"]})]})]}),b&&e.jsx("div",{className:"rounded-lg bg-red-500/10 border border-red-500/30 p-3 text-xs text-red-400",children:b}),e.jsx("div",{className:"flex gap-1 overflow-x-auto pb-2",children:r.cells.map((u,h)=>e.jsx("button",{onClick:()=>n(h),className:`px-3 py-1.5 rounded text-xs shrink-0 transition
                  ${h===o?"bg-primary/20 text-primary":"bg-gray-800 text-gray-400 hover:text-gray-200"}`,children:u.type==="code"?`Code ${h+1}`:`MD ${h+1}`},h))}),r.cells[o]&&e.jsx(os,{code:r.cells[o].source,language:r.cells[o].type==="code"?"python":"markdown",title:`Cell ${o+1} (${r.cells[o].type})`})]}):null]})}const re={setup:{bg:"bg-blue-500/30",border:"border-blue-500/40",text:"text-blue-300"},automated:{bg:"bg-green-500/30",border:"border-green-500/40",text:"text-green-300"},manual:{bg:"bg-amber-500/30",border:"border-amber-500/40",text:"text-amber-300"},testing:{bg:"bg-purple-500/30",border:"border-purple-500/40",text:"text-purple-300"},deploy:{bg:"bg-cyan-500/30",border:"border-cyan-500/40",text:"text-cyan-300"},default:{bg:"bg-gray-500/30",border:"border-gray-500/40",text:"text-gray-300"}};function je(t){const s=t.toLowerCase();return/setup|init|prep|config/i.test(s)?"setup":/auto|convert|generat/i.test(s)?"automated":/manual|custom|hand/i.test(s)?"manual":/test|valid|verif|qa/i.test(s)?"testing":/deploy|release|ship|prod/i.test(s)?"deploy":"default"}function ce(){const t=S(n=>n.report),s=S(n=>n.valueAnalysis),r=m.useMemo(()=>t!=null&&t.estimatedTimeline&&t.estimatedTimeline.length>0?t.estimatedTimeline.map(n=>({label:n.phase,weeks:n.weeks,type:je(n.phase)})):s!=null&&s.implementationRoadmap&&s.implementationRoadmap.length>0?s.implementationRoadmap.map(n=>({label:n.phase,weeks:n.weeks,type:je(n.phase)})):[],[t,s]),a=m.useMemo(()=>r.reduce((n,i)=>n+i.weeks,0),[r]);if(m.useMemo(()=>Math.max(...r.map(n=>n.weeks),1),[r]),r.length===0)return e.jsx("div",{className:"rounded-lg border border-border bg-gray-800/30 p-6 text-center text-gray-500 text-sm",children:"No timeline data available. Run Step 5 (Report) first."});let l=0;const o=r.map(n=>{const i=l;return l+=n.weeks,{...n,startWeek:i,endWeek:i+n.weeks}});return e.jsxs("div",{className:"rounded-lg border border-border bg-gray-900/50 p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-4",children:"Migration Timeline"}),e.jsx("div",{className:"space-y-2",children:o.map((n,i)=>{const d=re[n.type]||re.default,c=Math.max(n.weeks/a*100,10);return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-40 shrink-0 text-right",children:e.jsx("span",{className:`text-xs font-medium ${d.text}`,children:n.label})}),e.jsx("div",{className:"flex-1 relative",children:e.jsx("div",{className:"h-8 bg-gray-800/50 rounded-lg overflow-hidden",children:e.jsx("div",{className:`h-full rounded-lg ${d.bg} border ${d.border} flex items-center px-2 transition-all duration-500`,style:{width:`${c}%`,marginLeft:`${n.startWeek/a*100}%`},children:e.jsxs("span",{className:"text-[10px] text-gray-300 whitespace-nowrap tabular-nums",children:[n.weeks,"w"]})})})}),e.jsxs("div",{className:"w-24 shrink-0 text-xs text-gray-500 tabular-nums",children:["W",n.startWeek+1," - W",n.endWeek]})]},i)})}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-border flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Total Duration"}),e.jsxs("span",{className:"text-sm font-medium text-gray-200 tabular-nums",children:[a," weeks"]})]}),e.jsx("div",{className:"flex items-center gap-3 mt-3 flex-wrap",children:Object.entries(re).filter(([n])=>n!=="default").map(([n,i])=>e.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[e.jsx("span",{className:`w-3 h-3 rounded ${i.bg} border ${i.border}`}),n.charAt(0).toUpperCase()+n.slice(1)]},n))})]})}const ve={critical:"bg-red-500/20 text-red-400 border-red-500/30",high:"bg-orange-500/20 text-orange-400 border-orange-500/30",medium:"bg-amber-500/20 text-amber-400 border-amber-500/30",low:"bg-green-500/20 text-green-400 border-green-500/30"};function is(){const t=S(o=>o.assessment);S(o=>o.analysis);const s=S(o=>o.report),r=N(o=>o.stepStatuses[4]),{runReport:a}=B(),l=t&&r!=="running";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-100 flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-pink-500/20 flex items-center justify-center text-sm text-pink-400 font-mono",children:"5"}),"Migration Report"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:"Gap playbook, risk matrix, and implementation timeline for the migration."})]}),e.jsx("button",{onClick:()=>a(),disabled:!l,className:`px-4 py-2 rounded-lg bg-primary text-white text-sm font-medium
            hover:bg-primary/80 disabled:opacity-40 disabled:cursor-not-allowed transition`,children:r==="running"?"Generating...":"Generate Report"})]}),t?r==="running"?e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-800/50 border border-border",children:[e.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-pink-400 border-t-transparent animate-spin"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Building migration report..."})]}):s&&r==="done"?e.jsxs("div",{className:"space-y-6",children:[s.summary&&e.jsxs("div",{className:"rounded-lg border border-border bg-gray-800/30 p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-2",children:"Summary"}),e.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:s.summary})]}),s.riskMatrix&&Object.keys(s.riskMatrix).length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Risk Matrix"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:Object.entries(s.riskMatrix).map(([o,n])=>e.jsxs("div",{className:"rounded-lg bg-gray-800/50 border border-border p-3 text-center",children:[e.jsx("p",{className:"text-lg font-bold text-gray-200 tabular-nums",children:n}),e.jsx("p",{className:"text-xs text-gray-500 capitalize mt-0.5",children:o.replace(/_/g," ")})]},o))})]}),s.gapPlaybook&&s.gapPlaybook.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:["Gap Playbook (",s.gapPlaybook.length," items)"]}),e.jsx("div",{className:"space-y-2",children:s.gapPlaybook.map((o,n)=>e.jsxs("div",{className:`rounded-lg border p-4 ${ve[o.severity]||"border-border"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-200",children:o.processor}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${ve[o.severity]}`,children:o.severity})]}),e.jsx("p",{className:"text-sm text-gray-400",children:o.gap}),o.remediation&&e.jsxs("p",{className:"text-sm text-gray-500 mt-2 italic",children:["Remediation: ",o.remediation]})]},n))})]}),e.jsx(ce,{}),s.estimatedTimeline&&s.estimatedTimeline.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Timeline Detail"}),e.jsx("div",{className:"relative",children:s.estimatedTimeline.map((o,n)=>e.jsxs("div",{className:"flex items-start gap-4 mb-4 last:mb-0",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-primary shrink-0 mt-1"}),n<s.estimatedTimeline.length-1&&e.jsx("div",{className:"w-0.5 h-full bg-border min-h-[32px]"})]}),e.jsx("div",{className:"flex-1 rounded-lg bg-gray-800/50 border border-border p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-200",children:o.phase}),e.jsxs("span",{className:"text-xs text-gray-500 tabular-nums",children:[o.weeks," week(s)"]})]})})]},n))})]})]}):null:e.jsx("div",{className:"rounded-lg border border-border bg-gray-800/30 p-8 text-center text-gray-500 text-sm",children:"Complete Steps 1-3 first"})]})}function cs(){const t=S(u=>u.finalReport),s=N(u=>u.stepStatuses[5]),{runFinalReport:r}=B(),a=S(u=>u.report),[l,o]=m.useState("summary"),n=S(u=>u.parsed),i=S(u=>u.assessment),[d,c]=m.useState(!1),[x,g]=m.useState(""),b=a&&s!=="running",p=async()=>{if(!(!n||!i)){c(!0),g("");try{const u=await Re({parsed:n,assessment:i}),h=URL.createObjectURL(u),f=document.createElement("a");f.href=h,f.download="databricks_asset_bundle.zip",f.click(),URL.revokeObjectURL(h)}catch(u){console.error("DAB export failed:",u),g(u instanceof Error?u.message:"DAB export failed. Please try again.")}finally{c(!1)}}},j=u=>{if(!t)return;let h,f,w;if(u==="json")h=JSON.stringify(t,null,2),f="application/json",w="json";else if(u==="markdown"){const $=[`# Migration Report
`,`**Generated:** ${t.generatedAt}
`,`## Executive Summary
`,t.executiveSummary,""];(t.sections||[]).forEach(I=>{$.push(`## ${I.title}
`,I.content,"")}),h=$.join(`
`),f="text/markdown",w="md"}else h=[t.executiveSummary,"",...(t.sections||[]).map($=>`${$.title}
${"-".repeat($.title.length)}
${$.content}`)].join(`

`),f="text/plain",w="txt";const C=new Blob([h],{type:f}),L=URL.createObjectURL(C),M=document.createElement("a");M.href=L,M.download=`final_report.${w}`,M.click(),URL.revokeObjectURL(L)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-100 flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-indigo-500/20 flex items-center justify-center text-sm text-indigo-400 font-mono",children:"6"}),"Final Report"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:"Executive summary, detailed sections, and multi-format export."})]}),e.jsx("button",{onClick:()=>r(),disabled:!b,className:`px-4 py-2 rounded-lg bg-primary text-white text-sm font-medium
            hover:bg-primary/80 disabled:opacity-40 disabled:cursor-not-allowed transition`,children:s==="running"?"Generating...":"Generate Final Report"})]}),a?s==="running"?e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-800/50 border border-border",children:[e.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-indigo-400 border-t-transparent animate-spin"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Building final report..."})]}):t&&s==="done"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Export as:"}),["json","markdown","text"].map(u=>e.jsx("button",{onClick:()=>j(u),className:"px-3 py-1 rounded-lg bg-gray-800 text-gray-300 text-xs hover:bg-gray-700 transition",children:u.toUpperCase()},u)),e.jsxs("button",{onClick:p,disabled:d||!n||!i,className:"px-3 py-1 rounded-lg bg-orange-600/80 text-white text-xs hover:bg-orange-500 disabled:opacity-40 transition flex items-center gap-1.5",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),d?"Exporting...":"Export DAB"]}),t.generatedAt&&e.jsxs("span",{className:"ml-auto text-xs text-gray-600",children:["Generated: ",t.generatedAt]})]}),x&&e.jsx("div",{className:"rounded-lg bg-red-500/10 border border-red-500/30 p-3 text-xs text-red-400",children:x}),e.jsx("div",{className:"flex gap-1 border-b border-border",children:["summary","sections","json"].map(u=>e.jsx("button",{onClick:()=>o(u),className:`px-4 py-2 text-sm font-medium border-b-2 transition
                  ${l===u?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-300"}`,children:u.charAt(0).toUpperCase()+u.slice(1)},u))}),l==="summary"&&e.jsxs("div",{className:"rounded-lg border border-border bg-gray-800/30 p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-200 mb-3",children:"Executive Summary"}),e.jsx("p",{className:"text-sm text-gray-400 leading-relaxed whitespace-pre-wrap",children:t.executiveSummary||"No summary available."})]}),l==="sections"&&e.jsxs("div",{className:"space-y-4",children:[(t.sections||[]).map((u,h)=>e.jsxs("div",{className:"rounded-lg border border-border bg-gray-800/30 p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-200 mb-2",children:u.title}),e.jsx("p",{className:"text-sm text-gray-400 leading-relaxed whitespace-pre-wrap",children:u.content})]},h)),(!t.sections||t.sections.length===0)&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-8",children:"No sections available."})]}),l==="json"&&e.jsx(He,{data:t.rawJson||t,rootLabel:"finalReport"})]}):null:e.jsx("div",{className:"rounded-lg border border-border bg-gray-800/30 p-8 text-center text-gray-500 text-sm",children:"Complete Step 5 first"})]})}function T(t){return t<=1?t*100:t}function Ne(t){const s=T(t);return s>=90?"text-green-400":s>=70?"text-amber-400":"text-red-400"}function we(t){const s=T(t);return s>=90?"bg-green-500":s>=70?"bg-amber-500":"bg-red-500"}function ds(){const t=S(o=>o.notebook),s=S(o=>o.validation),r=N(o=>o.stepStatuses[6]),{runValidate:a}=B(),l=t&&r!=="running";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-100 flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-teal-500/20 flex items-center justify-center text-sm text-teal-400 font-mono",children:"7"}),"Validate"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:"Validation scores, gaps, and errors."})]}),e.jsx("button",{onClick:()=>a(),disabled:!l,className:`px-4 py-2 rounded-lg bg-primary text-white text-sm font-medium
            hover:bg-primary/80 disabled:opacity-40 disabled:cursor-not-allowed transition`,children:r==="running"?"Validating...":"Run Validation"})]}),t?r==="running"?e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-800/50 border border-border",children:[e.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-teal-400 border-t-transparent animate-spin"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Running validation checks..."})]}):s&&r==="done"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-6 rounded-lg bg-gray-800/50 border border-border p-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:`text-4xl font-bold tabular-nums ${Ne(s.overallScore)}`,children:T(s.overallScore).toFixed(0)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Overall Score"})]}),e.jsx("div",{className:"flex-1 h-4 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all ${we(s.overallScore)}`,style:{width:`${T(s.overallScore)}%`}})}),e.jsx("span",{className:`px-3 py-1 rounded-lg text-sm font-medium ${T(s.overallScore)>=85?"bg-green-500/20 text-green-400":T(s.overallScore)>=60?"bg-amber-500/20 text-amber-400":"bg-red-500/20 text-red-400"}`,children:T(s.overallScore)>=85?"READY":T(s.overallScore)>=60?"NEEDS WORK":"NOT READY"})]}),s.scores&&s.scores.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Score Breakdown"}),e.jsx("div",{className:"space-y-3",children:s.scores.map((o,n)=>e.jsxs("div",{className:"rounded-lg bg-gray-800/30 border border-border p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-200",children:o.dimension}),e.jsxs("span",{className:`text-sm font-medium tabular-nums ${Ne(o.score)}`,children:[T(o.score).toFixed(0),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all ${we(o.score)}`,style:{width:`${T(o.score)}%`}})}),o.details&&e.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:o.details})]},n))})]}),s.gaps&&s.gaps.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:["Validation Gaps (",s.gaps.length,")"]}),e.jsx("div",{className:"space-y-2",children:s.gaps.map((o,n)=>{const i=String(o.type??"unknown"),d=String(o.message??""),c=o.name?String(o.name):null,x=o.source?String(o.source):null,g=o.destination?String(o.destination):null,b=i==="missing_processor";return e.jsxs("div",{className:`rounded-lg border p-4 ${b?"border-amber-500/30 bg-amber-500/5":"border-border bg-gray-800/30"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wide ${b?"bg-amber-500/20 text-amber-400":"bg-blue-500/20 text-blue-400"}`,children:i.replace(/_/g," ")}),c&&e.jsx("span",{className:"text-sm font-medium text-gray-200",children:c}),x&&g&&e.jsxs("span",{className:"text-xs text-gray-400 font-mono",children:[x," → ",g]})]}),d&&e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:d})]},n)})})]}),s.errors&&s.errors.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:["Errors (",s.errors.length,")"]}),e.jsx("div",{className:"space-y-2",children:s.errors.map((o,n)=>e.jsx("div",{className:"rounded-lg border border-red-500/30 bg-red-500/5 p-3",children:e.jsx("p",{className:"text-sm text-red-400",children:o})},n))})]})]}):null:e.jsx("div",{className:"rounded-lg border border-border bg-gray-800/30 p-8 text-center text-gray-500 text-sm",children:"Complete Step 4 (Convert) first"})]})}const ke={hourlyRate:150,monthlyInfraCost:5e3,teamSize:3,timeline:"standard"};function xs(t){const s=t.hourlyRate*40*t.teamSize,r=t.timeline==="fast"?.7:t.timeline==="conservative"?1.4:1;return Math.round(s*4*r+t.monthlyInfraCost*3)}function ms({onApply:t,onClose:s}){const[r,a]=m.useState({...ke}),l=m.useCallback((d,c)=>{a(x=>({...x,[d]:c}))},[]),o=m.useCallback(()=>{t({hourlyRate:r.hourlyRate,monthlyInfraCost:r.monthlyInfraCost,teamSize:r.teamSize,timeline:r.timeline})},[r,t]),n=m.useCallback(()=>{a({...ke})},[]),i=xs(r);return e.jsxs("div",{className:"rounded-lg border border-border bg-gray-900/80 p-5 space-y-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-200",children:"Custom Cost Parameters"}),e.jsx("button",{onClick:s,className:"text-gray-500 hover:text-gray-300 transition text-lg leading-none",children:"×"})]}),e.jsx("div",{className:"rounded-lg bg-blue-500/10 border border-blue-500/30 p-3 text-xs text-blue-400",children:"Default values are provided as starting points. Customize these to match your organization's actual costs for more accurate estimates."}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center justify-between text-xs text-gray-400 mb-1",children:[e.jsx("span",{children:"Hourly Developer Rate"}),e.jsxs("span",{className:"text-gray-300 font-medium tabular-nums",children:["$",r.hourlyRate,"/hr"]})]}),e.jsx("input",{type:"range",min:50,max:300,step:10,value:r.hourlyRate,onChange:d=>l("hourlyRate",Number(d.target.value)),className:"w-full h-1.5 bg-gray-700 rounded-full appearance-none cursor-pointer accent-primary"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mt-0.5",children:[e.jsx("span",{children:"$50"}),e.jsx("span",{children:"$300"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center justify-between text-xs text-gray-400 mb-1",children:[e.jsx("span",{children:"Current Infrastructure Monthly Cost"}),e.jsxs("span",{className:"text-gray-300 font-medium tabular-nums",children:["$",r.monthlyInfraCost.toLocaleString(),"/mo"]})]}),e.jsx("input",{type:"number",min:0,max:5e4,step:500,value:r.monthlyInfraCost,onChange:d=>l("monthlyInfraCost",Math.max(0,Math.min(5e4,Number(d.target.value)))),placeholder:"Default: $5,000/mo - customize to your costs",className:"w-full px-3 py-2 rounded-lg bg-gray-800 border border-border text-sm text-gray-200 tabular-nums focus:outline-none focus:border-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center justify-between text-xs text-gray-400 mb-1",children:[e.jsx("span",{children:"Team Size"}),e.jsxs("span",{className:"text-gray-300 font-medium tabular-nums",children:[r.teamSize," engineers"]})]}),e.jsx("input",{type:"number",min:0,max:20,value:r.teamSize,onChange:d=>l("teamSize",Math.max(1,Math.min(20,Number(d.target.value)))),placeholder:"Default: 3 engineers - adjust for your team",className:"w-full px-3 py-2 rounded-lg bg-gray-800 border border-border text-sm text-gray-200 tabular-nums focus:outline-none focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Migration Timeline Preference"}),e.jsx("div",{className:"flex gap-2",children:["fast","standard","conservative"].map(d=>e.jsx("button",{onClick:()=>l("timeline",d),className:`flex-1 px-3 py-2 rounded-lg text-xs font-medium transition border ${r.timeline===d?"bg-primary/20 border-primary text-primary":"bg-gray-800 border-border text-gray-400 hover:text-gray-200"}`,children:d==="fast"?"Fast (Parallel)":d==="standard"?"Standard":"Conservative"},d))})]}),e.jsxs("div",{className:"rounded-lg bg-gray-800/50 border border-border p-3 text-center",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Estimated Total Cost"}),e.jsxs("p",{className:"text-xl font-bold text-gray-100 tabular-nums",children:["$",i.toLocaleString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:n,className:"flex-1 px-3 py-2 rounded-lg border border-border text-xs text-gray-400 hover:text-gray-200 hover:bg-gray-800 transition",children:"Reset to Defaults"}),e.jsx("button",{onClick:o,className:"flex-1 px-3 py-2 rounded-lg bg-primary text-white text-xs font-medium hover:bg-primary/80 transition",children:"Apply"})]})]})}function ps(t){const s=t*2e3;return{comparison:{liftAndShift:{cost:s,weeks:Math.ceil(t*.5),risk:.3,description:"Direct migration with minimal changes. Faster but retains legacy patterns."},refactor:{cost:s*1.6,weeks:Math.ceil(t*.9),risk:.15,description:"Full refactor to idiomatic Databricks patterns. Higher upfront cost, lower long-term risk."},recommendation:t>20?"Refactor recommended due to flow complexity":"Lift-and-shift is cost-effective for this flow size",breakEvenMonths:t>20?8:14},tco:{currentPlatform:{year1:6e4,year3:18e4,year5:3e5},databricks:{year1:42e3,year3:115e3,year5:18e4},migrationCost:s,savingsYear1:18e3-s,savingsYear3:65e3,savingsYear5:12e4},fteImpact:{roles:[{role:"Data Engineer",hours:t*8,fteMonths:+(t*8/160).toFixed(1),tasks:["Processor migration","Unit testing"]},{role:"Senior DE",hours:t*4,fteMonths:+(t*4/160).toFixed(1),tasks:["Architecture review","Code review"]},{role:"Architect",hours:t*2,fteMonths:+(t*2/160).toFixed(1),tasks:["Design patterns","Platform decisions"]},{role:"QA Engineer",hours:t*3,fteMonths:+(t*3/160).toFixed(1),tasks:["Integration testing","Validation"]}],totalHours:t*17,totalFteMonths:+(t*17/160).toFixed(1),phases:[{phase:"Discovery",roles:["Architect","Senior DE"],weeks:2},{phase:"Migration",roles:["Data Engineer","Senior DE"],weeks:Math.ceil(t*.4)},{phase:"Testing",roles:["QA Engineer","Data Engineer"],weeks:Math.ceil(t*.2)},{phase:"Cutover",roles:["Architect","Senior DE","QA Engineer"],weeks:1}]},licenseSavings:{currentLicense:6e4,databricksLicense:42e3,annualSavings:18e3,platforms:[{platform:"NiFi Cluster",cost:36e3,notes:"Hosting + maintenance"},{platform:"Supporting Infrastructure",cost:24e3,notes:"ZooKeeper, monitoring, storage"}]},monteCarlo:{p10:s*.7,p25:s*.85,p50:s,p75:s*1.2,p90:s*1.5,mean:s*1.05,std:s*.25,histogram:Array.from({length:20},(r,a)=>{const l=s*.5+s*1.2/20*a,o=l+s*1.2/20,n=(a-10)/5,i=Math.round(100*Math.exp(-n*n/2));return{binStart:Math.round(l),binEnd:Math.round(o),count:i}})},benchmarks:{flowSize:t>50?"Large":t>15?"Medium":"Small",processorCount:t,percentile:Math.min(95,Math.round(t*2.5)),avgMigrationWeeks:t>50?16:t>15?8:4,estimatedWeeks:Math.ceil(t*.5),comparisonNotes:`This flow is in the ${t>50?"top quartile":t>15?"median range":"lower quartile"} for complexity.`},complexity:{overall:Math.min(100,t*3),distribution:{low:Math.round(t*.4),medium:Math.round(t*.3),high:Math.round(t*.2),critical:Math.round(t*.1)},processors:[]}}}function us({risk:t}){const s=t<.2?"Low":t<.4?"Medium":"High",r=t<.2?"text-green-400 bg-green-500/10":t<.4?"text-amber-400 bg-amber-500/10":"text-red-400 bg-red-500/10";return e.jsxs("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${r}`,children:[s," (",(t*100).toFixed(0),"%)"]})}function Se({title:t,scenario:s,recommended:r}){return e.jsxs("div",{className:`rounded-lg border p-5 ${r?"border-green-500/50 bg-green-500/5":"border-border bg-gray-800/30"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-200",children:t}),r&&e.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium bg-green-500/20 text-green-400",children:"Recommended"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Cost"}),e.jsxs("p",{className:"text-lg font-bold text-gray-100 tabular-nums",children:["$",s.cost.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Duration"}),e.jsxs("p",{className:"text-lg font-bold text-gray-100 tabular-nums",children:[s.weeks,"w"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Risk"}),e.jsx(us,{risk:s.risk})]})]}),e.jsx("p",{className:"text-xs text-gray-400 leading-relaxed",children:s.description})]})}function gs({tco:t}){const s=Math.max(t.currentPlatform.year5,t.databricks.year5),r=(l,o)=>e.jsx("div",{className:`h-5 rounded ${o} flex items-center px-2`,style:{width:`${Math.max(5,l/s*100)}%`},children:e.jsxs("span",{className:"text-xs text-white font-medium tabular-nums whitespace-nowrap",children:["$",(l/1e3).toFixed(0),"K"]})}),a=[["Year 1",t.currentPlatform.year1,t.databricks.year1,t.savingsYear1],["Year 3",t.currentPlatform.year3,t.databricks.year3,t.savingsYear3],["Year 5",t.currentPlatform.year5,t.databricks.year5,t.savingsYear5]];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-red-500/70"})," Current Platform"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-blue-500/70"})," Databricks"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-green-500/70"})," Savings"]})]}),a.map(([l,o,n,i])=>e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:l}),e.jsxs("div",{className:"space-y-1",children:[r(o,"bg-red-500/70"),r(n,"bg-blue-500/70"),i>0&&r(i,"bg-green-500/70")]})]},l)),e.jsxs("div",{className:"rounded-lg bg-gray-800/50 border border-border p-3 text-center",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"One-time Migration Cost"}),e.jsxs("p",{className:"text-lg font-bold text-amber-400 tabular-nums",children:["$",t.migrationCost.toLocaleString()]})]})]})}function hs({fteImpact:t}){return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-lg border border-border overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900/60 border-b border-border",children:[e.jsx("th",{className:"text-left px-4 py-2.5 text-xs font-medium text-gray-500 uppercase",children:"Role"}),e.jsx("th",{className:"text-right px-4 py-2.5 text-xs font-medium text-gray-500 uppercase",children:"Hours"}),e.jsx("th",{className:"text-right px-4 py-2.5 text-xs font-medium text-gray-500 uppercase",children:"FTE Months"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-xs font-medium text-gray-500 uppercase",children:"Key Tasks"})]})}),e.jsxs("tbody",{className:"divide-y divide-border",children:[t.roles.map(s=>e.jsxs("tr",{className:"hover:bg-gray-800/30 transition",children:[e.jsx("td",{className:"px-4 py-2.5 text-gray-200 font-medium",children:s.role}),e.jsx("td",{className:"px-4 py-2.5 text-right text-gray-300 tabular-nums",children:s.hours}),e.jsx("td",{className:"px-4 py-2.5 text-right text-gray-300 tabular-nums",children:s.fteMonths}),e.jsx("td",{className:"px-4 py-2.5 text-gray-400 text-xs",children:s.tasks.join(", ")})]},s.role)),e.jsxs("tr",{className:"bg-gray-900/40 font-semibold",children:[e.jsx("td",{className:"px-4 py-2.5 text-gray-200",children:"Total"}),e.jsx("td",{className:"px-4 py-2.5 text-right text-gray-200 tabular-nums",children:t.totalHours}),e.jsx("td",{className:"px-4 py-2.5 text-right text-gray-200 tabular-nums",children:t.totalFteMonths}),e.jsx("td",{className:"px-4 py-2.5"})]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wider",children:"Phase Timeline"}),t.phases.map(s=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-gray-400 w-24 truncate",children:s.phase}),e.jsx("div",{className:"flex-1 h-6 bg-gray-800 rounded overflow-hidden flex items-center",children:e.jsx("div",{className:"h-full bg-primary/30 rounded flex items-center px-2",style:{width:`${Math.max(10,s.weeks/20*100)}%`},children:e.jsxs("span",{className:"text-xs text-gray-300 whitespace-nowrap",children:[s.weeks,"w - ",s.roles.join(", ")]})})})]},s.phase))]})]})}function bs({mc:t}){const s=Math.max(...t.histogram.map(r=>r.count),1);return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-end gap-px h-40",children:t.histogram.map((r,a)=>{const l=r.count/s*100,o=120-a/t.histogram.length*120;return e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end h-full group relative",children:[e.jsx("div",{className:"w-full rounded-t",style:{height:`${Math.max(2,l)}%`,backgroundColor:`hsl(${o}, 60%, 45%)`}}),e.jsxs("div",{className:"absolute bottom-full mb-1 hidden group-hover:block bg-gray-900 border border-border rounded px-2 py-1 text-xs text-gray-300 whitespace-nowrap z-10",children:["$",(r.binStart/1e3).toFixed(0),"K - $",(r.binEnd/1e3).toFixed(0),"K: ",r.count," runs"]})]},a)})}),e.jsx("div",{className:"grid grid-cols-5 gap-2 text-center",children:["p10","p25","p50","p75","p90"].map(r=>e.jsxs("div",{className:"rounded bg-gray-800/50 border border-border p-2",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase",children:r}),e.jsxs("p",{className:"text-sm font-bold text-gray-200 tabular-nums",children:["$",(t[r]/1e3).toFixed(0),"K"]})]},r))}),e.jsxs("div",{className:"flex gap-4 text-xs text-gray-500",children:[e.jsxs("span",{children:["Mean: $",(t.mean/1e3).toFixed(0),"K"]}),e.jsxs("span",{children:["Std Dev: $",(t.std/1e3).toFixed(0),"K"]})]})]})}function fs({b:t}){return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"rounded-lg bg-gray-800/50 border border-border p-3 text-center",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Flow Size"}),e.jsx("p",{className:"text-sm font-bold text-gray-200",children:t.flowSize})]}),e.jsxs("div",{className:"rounded-lg bg-gray-800/50 border border-border p-3 text-center",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Processors"}),e.jsx("p",{className:"text-sm font-bold text-gray-200 tabular-nums",children:t.processorCount})]}),e.jsxs("div",{className:"rounded-lg bg-gray-800/50 border border-border p-3 text-center",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Percentile"}),e.jsxs("p",{className:"text-sm font-bold text-gray-200 tabular-nums",children:[t.percentile,"th"]})]})]}),e.jsxs("div",{className:"rounded-lg bg-gray-800/50 border border-border p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Migration Duration Comparison"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-gray-400 w-28",children:"Industry Avg"}),e.jsx("div",{className:"flex-1 h-4 bg-gray-800 rounded overflow-hidden",children:e.jsx("div",{className:"h-full bg-gray-500/50 rounded",style:{width:`${t.avgMigrationWeeks/Math.max(t.avgMigrationWeeks,t.estimatedWeeks)*100}%`}})}),e.jsxs("span",{className:"text-xs text-gray-400 tabular-nums w-12 text-right",children:[t.avgMigrationWeeks,"w"]})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("span",{className:"text-xs text-gray-400 w-28",children:"This Flow"}),e.jsx("div",{className:"flex-1 h-4 bg-gray-800 rounded overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary/60 rounded",style:{width:`${t.estimatedWeeks/Math.max(t.avgMigrationWeeks,t.estimatedWeeks)*100}%`}})}),e.jsxs("span",{className:"text-xs text-primary tabular-nums w-12 text-right",children:[t.estimatedWeeks,"w"]})]})]}),e.jsx("p",{className:"text-xs text-gray-400",children:t.comparisonNotes})]})}function ys({ls:t}){return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"rounded-lg bg-red-500/5 border border-red-500/20 p-4 text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-red-400 tabular-nums",children:["$",(t.currentLicense/1e3).toFixed(0),"K"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Current License/yr"})]}),e.jsxs("div",{className:"rounded-lg bg-blue-500/5 border border-blue-500/20 p-4 text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-400 tabular-nums",children:["$",(t.databricksLicense/1e3).toFixed(0),"K"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Databricks/yr"})]}),e.jsxs("div",{className:"rounded-lg bg-green-500/5 border border-green-500/20 p-4 text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-green-400 tabular-nums",children:["$",(t.annualSavings/1e3).toFixed(0),"K"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Annual Savings"})]})]}),t.platforms.length>0&&e.jsx("div",{className:"rounded-lg border border-border overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900/60 border-b border-border",children:[e.jsx("th",{className:"text-left px-4 py-2 text-xs font-medium text-gray-500 uppercase",children:"Platform"}),e.jsx("th",{className:"text-right px-4 py-2 text-xs font-medium text-gray-500 uppercase",children:"Cost/yr"}),e.jsx("th",{className:"text-left px-4 py-2 text-xs font-medium text-gray-500 uppercase",children:"Notes"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:t.platforms.map(s=>e.jsxs("tr",{className:"hover:bg-gray-800/30 transition",children:[e.jsx("td",{className:"px-4 py-2 text-gray-200",children:s.platform}),e.jsxs("td",{className:"px-4 py-2 text-right text-gray-300 tabular-nums",children:["$",s.cost.toLocaleString()]}),e.jsx("td",{className:"px-4 py-2 text-gray-400 text-xs",children:s.notes})]},s.platform))})]})})]})}function js(){var h;const t=S(f=>f.parsed),s=S(f=>f.assessment),r=S(f=>f.roiReport),a=S(f=>f.setROIReport),l=S(f=>f.valueAnalysis),[o,n]=m.useState(!1),[i,d]=m.useState(null),[c,x]=m.useState(!1),g=((h=t==null?void 0:t.processors)==null?void 0:h.length)??0,b=m.useCallback(async f=>{n(!0),d(null);try{const w=await Ye({parsed:t,assessment:s,type:"roi",...f});a(w)}catch(w){const C=w instanceof Error?w.message:String(w);d(C);const L=ps(g);a(L)}finally{n(!1)}},[t,s,g,a]);m.useEffect(()=>{t&&!r&&!o&&b()},[t]);const p=m.useCallback(f=>{x(!1),b(f)},[b]);if(!t)return e.jsx("div",{className:"rounded-lg border border-border bg-gray-800/30 p-8 text-center text-gray-500 text-sm",children:"Complete Step 1 first to generate ROI analysis."});if(o)return e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-800/50 border border-border",children:[e.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-orange-400 border-t-transparent animate-spin"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Generating ROI analysis..."})]});if(!r)return null;const j=r.comparison.recommendation.toLowerCase().includes("refactor"),u=i?"(Estimated) ":"";return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"ROI Dashboard"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>x(!c),className:"px-3 py-1.5 rounded-lg border border-border text-xs text-gray-400 hover:text-gray-200 hover:bg-gray-800 transition",children:"Customize Costs"}),e.jsx("button",{onClick:()=>b(),className:"px-3 py-1.5 rounded-lg bg-primary text-white text-xs font-medium hover:bg-primary/80 transition",children:"Refresh"})]})]}),i&&e.jsxs("div",{className:"rounded-lg border border-red-500/40 bg-red-500/10 p-4 text-sm text-red-400 font-medium",children:[e.jsx("p",{className:"mb-1",children:"Estimated values only — backend unavailable."}),e.jsx("p",{className:"text-xs text-red-400/70 font-normal",children:"These numbers are rough approximations, not based on your actual flow data."})]}),!l&&e.jsx("div",{className:"rounded-lg bg-amber-500/10 border border-amber-500/30 p-3 text-xs text-amber-400",children:"Showing estimated sample data. Run the full pipeline for actual ROI analysis."}),c&&e.jsx(ms,{onApply:p,onClose:()=>x(!1)}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-300 mb-3",children:[u,"Migration Strategy Comparison"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(Se,{title:"Lift & Shift",scenario:r.comparison.liftAndShift,recommended:!j}),e.jsx(Se,{title:"Refactor",scenario:r.comparison.refactor,recommended:j})]}),e.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[e.jsx("p",{className:"text-sm text-gray-400 flex-1",children:r.comparison.recommendation}),e.jsxs("span",{className:"px-3 py-1 rounded-full bg-primary/10 text-primary text-xs font-medium whitespace-nowrap",children:["Break-even: ",r.comparison.breakEvenMonths," months"]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-300 mb-3",children:[u,"Total Cost of Ownership"]}),e.jsx(gs,{tco:r.tco})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-300 mb-3",children:[u,"FTE Impact"]}),e.jsx(hs,{fteImpact:r.fteImpact})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-300 mb-3",children:[u,"Monte Carlo Cost Distribution"]}),e.jsx(bs,{mc:r.monteCarlo})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-300 mb-3",children:[u,"Benchmark Comparison"]}),e.jsx(fs,{b:r.benchmarks})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-300 mb-3",children:[u,"License Savings"]}),e.jsx(ys,{ls:r.licenseSavings})]})]})}function vs(){var d;const t=S(c=>c.parsed),s=S(c=>c.valueAnalysis),r=N(c=>c.stepStatuses[7]),{runValueAnalysis:a}=B(),[l,o]=m.useState("value"),n=t&&r!=="running",i=((d=s==null?void 0:s.droppableProcessors)==null?void 0:d.reduce((c,x)=>c+x.savingsHours,0))??0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-100 flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-orange-500/20 flex items-center justify-center text-sm text-orange-400 font-mono",children:"8"}),"Value Analysis"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:"Identify droppable processors, complexity breakdown, ROI estimate, and implementation roadmap."})]}),e.jsx("button",{onClick:()=>a(),disabled:!n,className:`px-4 py-2 rounded-lg bg-primary text-white text-sm font-medium
            hover:bg-primary/80 disabled:opacity-40 disabled:cursor-not-allowed transition`,children:r==="running"?"Analyzing...":"Run Value Analysis"})]}),e.jsxs("div",{className:"flex border-b border-border",children:[e.jsx("button",{onClick:()=>o("value"),className:`px-4 py-2 text-sm font-medium border-b-2 transition ${l==="value"?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-300"}`,children:"Value Analysis"}),e.jsx("button",{onClick:()=>o("roi"),className:`px-4 py-2 text-sm font-medium border-b-2 transition ${l==="roi"?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-300"}`,children:"ROI Dashboard"})]}),l==="roi"?e.jsx(js,{}):e.jsx(e.Fragment,{children:t?r==="running"?e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-800/50 border border-border",children:[e.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-orange-400 border-t-transparent animate-spin"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Running value analysis..."})]}):s&&r==="done"?e.jsxs("div",{className:"space-y-6",children:[s.roiEstimate&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"ROI Estimate"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"rounded-lg bg-green-500/5 border border-green-500/20 p-4 text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-green-400 tabular-nums",children:["$",s.roiEstimate.costSavings.toLocaleString()]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Cost Savings"})]}),e.jsxs("div",{className:"rounded-lg bg-blue-500/5 border border-blue-500/20 p-4 text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-400 tabular-nums",children:[s.roiEstimate.timeSavings,"h"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Time Savings"})]}),e.jsxs("div",{className:"rounded-lg bg-purple-500/5 border border-purple-500/20 p-4 text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-purple-400 tabular-nums",children:[s.roiEstimate.riskReduction,"%"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Risk Reduction"})]})]})]}),s.droppableProcessors&&s.droppableProcessors.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:["Droppable Processors (",s.droppableProcessors.length,") -- ",i,"h savings"]}),e.jsx("div",{className:"rounded-lg border border-border overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900/60 border-b border-border",children:[e.jsx("th",{className:"text-left px-4 py-2.5 text-xs font-medium text-gray-500 uppercase",children:"Processor"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-xs font-medium text-gray-500 uppercase",children:"Reason"}),e.jsx("th",{className:"text-right px-4 py-2.5 text-xs font-medium text-gray-500 uppercase",children:"Savings (h)"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:s.droppableProcessors.map((c,x)=>e.jsxs("tr",{className:"hover:bg-gray-800/30 transition",children:[e.jsx("td",{className:"px-4 py-2.5 text-gray-200 font-medium",children:c.name}),e.jsx("td",{className:"px-4 py-2.5 text-gray-400 font-mono text-xs",children:c.type}),e.jsx("td",{className:"px-4 py-2.5 text-gray-400",children:c.reason}),e.jsx("td",{className:"px-4 py-2.5 text-right text-green-400 font-medium tabular-nums",children:c.savingsHours})]},x))})]})})]}),s.complexityBreakdown&&Object.keys(s.complexityBreakdown).length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Complexity Breakdown"}),e.jsx("div",{className:"space-y-2",children:Object.entries(s.complexityBreakdown).map(([c,x])=>{const g=Object.values(s.complexityBreakdown).reduce((p,j)=>p+j,0),b=g>0?x/g*100:0;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-gray-400 w-28 truncate capitalize",children:c.replace(/_/g," ")}),e.jsx("div",{className:"flex-1 h-2 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-orange-500 rounded-full",style:{width:`${b}%`}})}),e.jsx("span",{className:"text-xs text-gray-500 w-12 text-right tabular-nums",children:x})]},c)})})]}),s.implementationRoadmap&&s.implementationRoadmap.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Implementation Roadmap"}),e.jsx("div",{className:"space-y-3",children:s.implementationRoadmap.map((c,x)=>e.jsxs("div",{className:"rounded-lg border border-border bg-gray-800/30 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-200",children:c.phase}),e.jsxs("span",{className:"text-xs text-gray-500 tabular-nums",children:[c.weeks," week(s)"]})]}),e.jsx("ul",{className:"space-y-1",children:c.tasks.map((g,b)=>e.jsxs("li",{className:"text-xs text-gray-400 flex items-start gap-2",children:[e.jsx("span",{className:"text-gray-600 mt-0.5",children:"•"}),g]},b))})]},x))})]})]}):null:e.jsx("div",{className:"rounded-lg border border-border bg-gray-800/30 p-8 text-center text-gray-500 text-sm",children:"Complete Step 1 first"})})]})}function Ce(){const t=S(i=>i.assessment),{segments:s,total:r,coveragePct:a}=m.useMemo(()=>{var p;if(!((p=t==null?void 0:t.mappings)!=null&&p.length))return{segments:[],total:0,coveragePct:0};let i=0,d=0,c=0;t.mappings.forEach(j=>{const u=j.confidence<=1?j.confidence*100:j.confidence;j.mapped?u<70?c++:i++:d++});const x=i+d+c,g=x>0?Math.round(i/x*100):0;return{segments:[{label:"Mapped",count:i,color:"#22C55E",strokeColor:"text-green-400"},{label:"Low Confidence",count:c,color:"#EAB308",strokeColor:"text-amber-400"},{label:"Unmapped",count:d,color:"#EF4444",strokeColor:"text-red-400"}],total:x,coveragePct:g}},[t]);if(r===0)return e.jsx("div",{className:"rounded-lg border border-border bg-gray-800/30 p-6 text-center text-gray-500 text-sm",children:"No mapping data. Run Step 3 (Assess) first."});const l=40,o=2*Math.PI*l;let n=0;return e.jsxs("div",{className:"rounded-lg border border-border bg-gray-900/50 p-4 flex flex-col items-center",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-3 self-start",children:"Coverage"}),e.jsxs("svg",{width:100,height:100,className:"-rotate-90",children:[e.jsx("circle",{cx:50,cy:50,r:l,fill:"none",stroke:"#1f2937",strokeWidth:10}),s.filter(i=>i.count>0).map(i=>{const d=i.count/r*o,c=o-n;return n+=d,e.jsx("circle",{cx:50,cy:50,r:l,fill:"none",stroke:i.color,strokeWidth:10,strokeLinecap:"round",strokeDasharray:`${d} ${o-d}`,strokeDashoffset:c,className:"transition-all duration-1000"},i.label)})]}),e.jsxs("span",{className:"text-xl font-bold text-gray-200 -mt-[64px] mb-[40px]",children:[a,"%"]}),e.jsx("div",{className:"flex items-center gap-4 mt-2",children:s.map(i=>e.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-gray-400",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{backgroundColor:i.color}}),i.label," (",i.count,")"]},i.label))})]})}function Ns(){const[t,s]=m.useState(null),r=a=>{s(l=>l===a?null:a)};return t?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-300",children:[t.charAt(0).toUpperCase()+t.slice(1)," View"]}),e.jsx("button",{onClick:()=>s(null),className:"text-xs text-gray-500 hover:text-gray-300 transition",children:"Back to Dashboard"})]}),t==="coverage"&&e.jsx(Ce,{}),t==="confidence"&&e.jsx(oe,{}),t==="risk"&&e.jsx(ie,{}),t==="timeline"&&e.jsx(ce,{}),t==="security"&&e.jsx(le,{})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300",children:"Visual Dashboard"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx(_,{title:"Coverage",onExpand:()=>r("coverage"),children:e.jsx(Ce,{})}),e.jsx(_,{title:"Confidence",onExpand:()=>r("confidence"),children:e.jsx(oe,{})}),e.jsx(_,{title:"Risk Heatmap",onExpand:()=>r("risk"),children:e.jsx(ie,{})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(_,{title:"Migration Timeline",onExpand:()=>r("timeline"),children:e.jsx(ce,{})})}),e.jsx(_,{title:"Security",onExpand:()=>r("security"),children:e.jsx(le,{})})]})]})}function _({title:t,onExpand:s,children:r}){return e.jsxs("div",{className:"rounded-lg border border-border bg-gray-900/30 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-border bg-gray-800/30",children:[e.jsx("span",{className:"text-xs font-medium text-gray-400",children:t}),e.jsx("button",{onClick:s,className:"text-[10px] text-gray-500 hover:text-gray-300 transition",children:"View Full"})]}),e.jsx("div",{className:"p-2",children:r})]})}function ae({value:t,label:s,color:r}){const l=2*Math.PI*36,o=l-t/100*l;return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("svg",{width:"88",height:"88",className:"-rotate-90",children:[e.jsx("circle",{cx:"44",cy:"44",r:36,fill:"none",stroke:"#1f2937",strokeWidth:"6"}),e.jsx("circle",{cx:"44",cy:"44",r:36,fill:"none",stroke:r,strokeWidth:"6",strokeLinecap:"round",strokeDasharray:l,strokeDashoffset:o,className:"transition-all duration-1000"})]}),e.jsxs("span",{className:"text-lg font-bold text-gray-200 -mt-[58px] mb-[30px]",children:[t,"%"]}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:s})]})}function ws(){const{fileName:t,platform:s,parsed:r,analysis:a,assessment:l,notebook:o,report:n,finalReport:i,validation:d,valueAnalysis:c}=S(),x=N(A=>A.stepStatuses),{percent:g}=me(),b=(l==null?void 0:l.mappings.filter(A=>A.mapped).length)??0,p=(l==null?void 0:l.mappings.length)??1,j=p>0?Math.round(b/p*100):0,u=(d==null?void 0:d.overallScore)??0,h=u<=1?Math.round(u*100):Math.round(u),f=(t||"export").replace(/\.[^.]+$/,""),w=(A,y)=>{const k=URL.createObjectURL(A),v=document.createElement("a");v.href=k,v.download=y,v.click(),URL.revokeObjectURL(k)},C=()=>{const A={fileName:t,platform:s,parsed:r,analysis:a,assessment:l,notebook:o?{cellCount:o.cells.length}:null,report:n,finalReport:i,validation:d,valueAnalysis:c,exportedAt:new Date().toISOString()};w(new Blob([JSON.stringify(A,null,2)],{type:"application/json"}),`migration_summary_${f}.json`)},L=()=>{if(!o)return;const A=JSON.stringify({nbformat:4,nbformat_minor:5,metadata:{kernelspec:{display_name:"Python 3",language:"python",name:"python3"}},cells:o.cells.map(y=>({cell_type:y.type,source:y.source.split(`
`),metadata:{},...y.type==="code"?{outputs:[],execution_count:null}:{}}))},null,2);w(new Blob([A],{type:"application/json"}),`${f}_notebook.ipynb`)},M=()=>{if(!o)return;const A=o.cells.filter(y=>y.type==="code").map(y=>y.source).join(`

# ──────────────────────────────────────

`);w(new Blob([A],{type:"text/plain"}),`${f}_notebook.py`)},$=()=>{if(!n&&!i)return;const A={report:n,finalReport:i,exportedAt:new Date().toISOString()};w(new Blob([JSON.stringify(A,null,2)],{type:"application/json"}),`${f}_report.json`)},I=()=>{d&&w(new Blob([JSON.stringify(d,null,2)],{type:"application/json"}),`${f}_validation.json`)},z=["Parse","Analyze","Assess","Convert","Report","Final Report","Validate","Value Analysis"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-100 flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-gray-500/20 flex items-center justify-center text-sm text-gray-400",children:"Σ"}),"Pipeline Summary"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:t?`Results for ${t}`:"All pipeline outputs aggregated"})]}),e.jsx("button",{onClick:C,className:`px-4 py-2 rounded-lg bg-primary text-white text-sm font-medium
            hover:bg-primary/80 transition`,children:"Export All (JSON)"})]}),e.jsxs("div",{className:"rounded-lg bg-gray-800/50 border border-border p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Downloads"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:L,disabled:!o,className:`px-3 py-2 rounded-lg bg-green-600/80 text-white text-xs font-medium
              hover:bg-green-500 disabled:opacity-30 disabled:cursor-not-allowed transition flex items-center gap-1.5`,children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Notebook (.ipynb)"]}),e.jsxs("button",{onClick:M,disabled:!o,className:`px-3 py-2 rounded-lg bg-blue-600/80 text-white text-xs font-medium
              hover:bg-blue-500 disabled:opacity-30 disabled:cursor-not-allowed transition flex items-center gap-1.5`,children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"Notebook (.py)"]}),e.jsxs("button",{onClick:$,disabled:!n&&!i,className:`px-3 py-2 rounded-lg bg-purple-600/80 text-white text-xs font-medium
              hover:bg-purple-500 disabled:opacity-30 disabled:cursor-not-allowed transition flex items-center gap-1.5`,children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Migration Report"]}),e.jsxs("button",{onClick:I,disabled:!d,className:`px-3 py-2 rounded-lg bg-amber-600/80 text-white text-xs font-medium
              hover:bg-amber-500 disabled:opacity-30 disabled:cursor-not-allowed transition flex items-center gap-1.5`,children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Validation Report"]})]})]}),e.jsxs("div",{className:"rounded-lg bg-gray-800/50 border border-border p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"Overall Progress"}),e.jsxs("span",{className:"text-sm font-medium text-gray-200 tabular-nums",children:[g,"%"]})]}),e.jsx("div",{className:"h-3 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${g===100?"bg-green-500":"bg-primary"}`,style:{width:`${g}%`}})})]}),e.jsxs("div",{className:"flex items-center justify-center gap-12 py-4",children:[e.jsx(ae,{value:j,label:"Confidence",color:j>=90?"#22c55e":j>=70?"#eab308":"#ef4444"}),e.jsx(ae,{value:h,label:"Validation",color:h>=90?"#22c55e":h>=70?"#eab308":"#ef4444"}),e.jsx(ae,{value:g,label:"Completion",color:"#FF4B4B"})]}),e.jsx(Ns,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Step Status"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:z.map((A,y)=>{const k=x[y],v={idle:"border-border text-gray-500",running:"border-primary/50 text-primary",done:"border-green-500/50 text-green-400",error:"border-red-500/50 text-red-400"},E={idle:"○",running:"◔",done:"✓",error:"✖"};return e.jsxs("div",{className:`rounded-lg border bg-gray-800/30 p-3 flex items-center gap-2 ${v[k]}`,children:[e.jsx("span",{className:"text-base",children:E[k]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium",children:A}),e.jsx("p",{className:"text-xs text-gray-600 capitalize",children:k})]})]},y)})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Key Outputs"}),e.jsxs("div",{className:"space-y-2",children:[a&&e.jsx(G,{label:"Analysis",detail:`${a.externalSystems.length} external systems, ${a.cycles.length} cycles`}),l&&e.jsx(G,{label:"Assessment",detail:`${b} mapped, ${l.unmappedCount} unmapped`}),o&&e.jsx(G,{label:"Notebook",detail:`${o.cells.length} cells`}),d&&e.jsx(G,{label:"Validation",detail:`Score: ${h}%, ${d.gaps.length} gaps, ${d.errors.length} errors`}),c&&e.jsx(G,{label:"Value Analysis",detail:`${c.droppableProcessors.length} droppable, $${c.roiEstimate.costSavings.toLocaleString()} savings`}),!a&&!l&&!o&&!d&&!c&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No outputs yet. Run the pipeline to see results."})]})]})]})}function G({label:t,detail:s}){return e.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-gray-800/30 border border-border px-4 py-2.5",children:[e.jsx("span",{className:"text-sm font-medium text-gray-200",children:t}),e.jsx("span",{className:"text-xs text-gray-400",children:s})]})}function Q({label:t,value:s,sublabel:r,color:a="text-primary",icon:l}){return e.jsx("div",{className:"rounded-lg border border-border bg-gray-900/50 p-4 hover:border-gray-600 transition",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:t}),e.jsx("p",{className:`text-2xl font-bold mt-1 ${a}`,children:s}),r&&e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:r})]}),l&&e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-800 flex items-center justify-center text-gray-400",children:l})]})})}const Ee={nifi:"#3B82F6",ssis:"#A855F7",informatica:"#EC4899",talend:"#21C354",airflow:"#EAB308",dbt:"#F97316",adf:"#06B6D4",unknown:"#6B7280"};function ks(){const[t,s]=m.useState(null),[r,a]=m.useState(!1),[l,o]=m.useState(null);if(m.useEffect(()=>{(async()=>{a(!0),o(null);try{const c=await Ke();s(c)}catch(c){o(c instanceof Error?c.message:"Failed to load dashboard")}finally{a(!1)}})()},[]),r)return e.jsx("p",{className:"text-sm text-gray-500",children:"Loading dashboard..."});if(l)return e.jsx("div",{className:"px-4 py-3 rounded-lg bg-red-500/10 border border-red-500/30 text-sm text-red-400",children:l});if(!t)return e.jsx("div",{className:"text-center py-12 border-2 border-dashed border-border rounded-lg",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"Dashboard data unavailable"})});const n=Object.entries(t.platformBreakdown),i=Math.max(1,...n.map(([,d])=>d));return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-100",children:"Portfolio Dashboard"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(Q,{label:"Total Runs",value:t.totalRuns,color:"text-primary"}),e.jsx(Q,{label:"Success Rate",value:`${t.successRate}%`,color:t.successRate>=90?"text-green-400":t.successRate>=70?"text-amber-400":"text-red-400"}),e.jsx(Q,{label:"Avg Duration",value:t.avgDurationMs<1e3?`${t.avgDurationMs}ms`:`${(t.avgDurationMs/1e3).toFixed(1)}s`,color:"text-blue-400"}),e.jsx(Q,{label:"Total Processors",value:t.totalProcessors,color:"text-purple-400"})]}),n.length>0&&e.jsxs("div",{className:"rounded-lg border border-border bg-gray-900/50 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-200 mb-4",children:"Platform Distribution"}),e.jsx("div",{className:"space-y-2",children:n.map(([d,c])=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-gray-400 w-24 text-right",children:d}),e.jsx("div",{className:"flex-1 h-6 bg-gray-800 rounded overflow-hidden",children:e.jsx("div",{className:"h-full rounded transition-all duration-500",style:{width:`${c/i*100}%`,backgroundColor:Ee[d]||Ee.unknown}})}),e.jsx("span",{className:"text-xs text-gray-400 w-8",children:c})]},d))})]}),t.totalRuns>0&&e.jsxs("div",{className:"rounded-lg border border-border bg-gray-900/50 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-200 mb-4",children:"Run Results"}),e.jsxs("div",{className:"flex items-center justify-center gap-8",children:[e.jsxs("svg",{width:"120",height:"120",viewBox:"0 0 120 120",role:"img","aria-label":"Success rate donut chart",children:[e.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"none",stroke:"#374151",strokeWidth:"12"}),e.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"none",stroke:"#21C354",strokeWidth:"12",strokeDasharray:`${t.successRate/100*314} 314`,strokeLinecap:"round",transform:"rotate(-90 60 60)"}),e.jsxs("text",{x:"60",y:"56",textAnchor:"middle",className:"fill-gray-100 text-lg font-bold",fontSize:"22",children:[t.successRate,"%"]}),e.jsx("text",{x:"60",y:"72",textAnchor:"middle",className:"fill-gray-500",fontSize:"10",children:"success"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-green-400"}),e.jsxs("span",{className:"text-sm text-gray-300",children:[t.completedRuns," completed"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-red-400"}),e.jsxs("span",{className:"text-sm text-gray-300",children:[t.failedRuns," failed"]})]})]})]})]}),t.recentRuns.length>0&&e.jsxs("div",{className:"rounded-lg border border-border bg-gray-900/50 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-2.5 bg-gray-900/80 border-b border-border",children:e.jsx("h3",{className:"text-sm font-semibold text-gray-200",children:"Recent Runs"})}),e.jsx("div",{className:"divide-y divide-border/50",children:t.recentRuns.map((d,c)=>e.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-300",children:String(d.fileName)}),e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:String(d.platform)})]}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${d.status==="completed"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:String(d.status)})]},c))})]})]})}function Ss({runId:t,onBack:s}){const[r,a]=m.useState(null),[l,o]=m.useState(!1),[n,i]=m.useState("");if(m.useEffect(()=>{(async()=>{o(!0);try{const g=await Je(t);a(g)}catch(g){i(g instanceof Error?g.message:"Failed to load run")}finally{o(!1)}})()},[t]),l)return e.jsx("p",{className:"text-sm text-gray-500",children:"Loading run details..."});if(n)return e.jsx("p",{className:"text-sm text-red-400",children:n});if(!r)return null;const d=r.stepsCompleted||[],c=r.resultSummary||{};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:s,className:"flex items-center gap-1 text-sm text-gray-400 hover:text-gray-200 transition","aria-label":"Back to run history",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to History"]}),e.jsxs("div",{className:"rounded-lg border border-border bg-gray-900/50 overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 bg-gray-900/80 border-b border-border",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-100",children:["Run ",String(r.id)]}),e.jsx("p",{className:"text-sm text-gray-400 mt-0.5",children:String(r.fileName)})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:String(r.processorCount)}),e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Processors"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-200",children:String(r.platform)}),e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Platform"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-200",children:Number(r.durationMs)<1e3?`${r.durationMs}ms`:`${(Number(r.durationMs)/1e3).toFixed(1)}s`}),e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Duration"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-2xl font-bold ${r.status==="completed"?"text-green-400":"text-red-400"}`,children:String(r.status)}),e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Status"})]})]}),d.length>0&&e.jsxs("div",{className:"px-4 pb-4",children:[e.jsx("h4",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-2",children:"Steps Completed"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:d.map((x,g)=>e.jsx("span",{className:"px-2 py-0.5 text-xs rounded bg-green-500/20 text-green-400",children:x},g))})]}),Object.keys(c).length>0&&e.jsxs("div",{className:"px-4 pb-4",children:[e.jsx("h4",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-2",children:"Result Summary"}),e.jsx("pre",{className:"text-xs text-gray-400 bg-gray-800/50 rounded p-3 overflow-auto max-h-48",children:JSON.stringify(c,null,2)})]})]})]})}function Cs(){const[t,s]=m.useState([]),[r,a]=m.useState(0),[l,o]=m.useState(!1),[n,i]=m.useState(null),[d,c]=m.useState(null);m.useEffect(()=>{(async()=>{o(!0),i(null);try{const j=await qe(50);s(j.runs||[]),a(j.total||0)}catch(j){i(j instanceof Error?j.message:"Failed to load run history")}finally{o(!1)}})()},[]);const x=p=>p<1e3?`${p}ms`:`${(p/1e3).toFixed(1)}s`,g=p=>{try{return new Date(p).toLocaleString()}catch{return p}},b=p=>{switch(p){case"completed":return"bg-green-500/20 text-green-400";case"failed":return"bg-red-500/20 text-red-400";case"running":return"bg-blue-500/20 text-blue-400 animate-pulse";default:return"bg-gray-500/20 text-gray-400"}};return d?e.jsx(Ss,{runId:d,onBack:()=>c(null)}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-100",children:"Run History"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[r," total runs"]})]}),l&&e.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}),n&&e.jsx("div",{className:"px-4 py-2 rounded-lg bg-red-500/10 border border-red-500/30 text-sm text-red-400",children:n}),t.length===0&&!l&&!n&&e.jsx("div",{className:"text-center py-12 border-2 border-dashed border-border rounded-lg",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"No runs recorded yet"})}),t.length>0&&e.jsx("div",{className:"rounded-lg border border-border overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",role:"table","aria-label":"Pipeline run history",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900/60 border-b border-border",children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"File"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Platform"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Processors"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Duration"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"})]})}),e.jsx("tbody",{children:t.map(p=>e.jsxs("tr",{className:"border-b border-border/50 hover:bg-gray-900/30 transition cursor-pointer",onClick:()=>c(p.id),children:[e.jsx("td",{className:"px-4 py-2.5 text-gray-300 font-medium",children:p.fileName}),e.jsx("td",{className:"px-4 py-2.5 text-gray-400",children:p.platform}),e.jsx("td",{className:"px-4 py-2.5 text-gray-400",children:p.processorCount}),e.jsx("td",{className:"px-4 py-2.5",children:e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${b(p.status)}`,children:p.status})}),e.jsx("td",{className:"px-4 py-2.5 text-gray-400 font-mono text-xs",children:x(p.durationMs)}),e.jsx("td",{className:"px-4 py-2.5 text-gray-500 text-xs",children:g(p.createdAt)}),e.jsx("td",{className:"px-4 py-2.5",children:e.jsx("button",{className:"text-xs text-primary hover:text-primary/80 transition","aria-label":`View details for run ${p.id}`,children:"Details"})})]},p.id))})]})})]})}function Es({data:t}){const s=t.flows||[];if(s.length===0)return null;const r=[{label:"Platform",key:"platform"},{label:"Processors",key:"processorCount"},{label:"Connections",key:"connectionCount"},{label:"Process Groups",key:"processGroupCount"},{label:"Controller Services",key:"controllerServiceCount"},{label:"Unique Types",key:"uniqueTypes"},{label:"Warnings",key:"warnings"}];return e.jsxs("div",{className:"rounded-lg border border-border overflow-hidden",children:[e.jsx("div",{className:"px-4 py-2.5 bg-gray-900/60 border-b border-border",children:e.jsx("h3",{className:"text-sm font-semibold text-gray-200",children:"Side-by-Side Metrics"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",role:"table","aria-label":"Flow comparison metrics",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border bg-gray-900/40",children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Metric"}),s.map((a,l)=>e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:a.label},l))]})}),e.jsx("tbody",{children:r.map(a=>e.jsxs("tr",{className:"border-b border-border/50 hover:bg-gray-900/30 transition",children:[e.jsx("td",{className:"px-4 py-2 text-gray-400 font-medium",children:a.label}),s.map((l,o)=>{const n=l[a.key],i=typeof n=="number"&&n===Math.max(...s.map(d=>Number(d[a.key])||0));return e.jsx("td",{className:`px-4 py-2 ${i?"text-primary font-semibold":"text-gray-300"}`,children:String(n)},o)})]},a.key))})]})})]})}const F=["#FF4B4B","#3B82F6","#21C354","#EAB308","#A855F7","#EC4899"],U=[{key:"processorCount",label:"Processors"},{key:"connectionCount",label:"Connections"},{key:"processGroupCount",label:"Groups"},{key:"controllerServiceCount",label:"Services"},{key:"uniqueTypes",label:"Types"},{key:"warnings",label:"Warnings"}];function Ms({data:t}){const s=t.flows||[];if(s.length===0)return null;const r=150,a=150,l=110,o=5,n=2*Math.PI/U.length,i=U.map(c=>Math.max(1,...s.map(x=>Number(x[c.key])||0))),d=c=>U.map((x,g)=>{const p=(Number(c[x.key])||0)/i[g],j=g*n-Math.PI/2,u=r+l*p*Math.cos(j),h=a+l*p*Math.sin(j);return`${u},${h}`}).join(" ");return e.jsxs("div",{className:"rounded-lg border border-border bg-gray-900/50 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-200 mb-4",children:"Radar Comparison"}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("svg",{width:"300",height:"300",viewBox:"0 0 300 300",className:"max-w-full",role:"img","aria-label":"Radar chart comparing flow metrics",children:[Array.from({length:o},(c,x)=>{const g=l*(x+1)/o,b=U.map((p,j)=>{const u=j*n-Math.PI/2;return`${r+g*Math.cos(u)},${a+g*Math.sin(u)}`}).join(" ");return e.jsx("polygon",{points:b,fill:"none",stroke:"#374151",strokeWidth:"0.5"},x)}),U.map((c,x)=>{const g=x*n-Math.PI/2,b=r+l*Math.cos(g),p=a+l*Math.sin(g),j=r+(l+20)*Math.cos(g),u=a+(l+20)*Math.sin(g);return e.jsxs("g",{children:[e.jsx("line",{x1:r,y1:a,x2:b,y2:p,stroke:"#4B5563",strokeWidth:"0.5"}),e.jsx("text",{x:j,y:u,textAnchor:"middle",dominantBaseline:"middle",className:"fill-gray-500 text-[9px]",children:c.label})]},c.key)}),s.map((c,x)=>e.jsx("polygon",{points:d(c),fill:F[x%F.length],fillOpacity:"0.15",stroke:F[x%F.length],strokeWidth:"1.5"},x)),s.map((c,x)=>U.map((g,b)=>{const j=(Number(c[g.key])||0)/i[b],u=b*n-Math.PI/2,h=r+l*j*Math.cos(u),f=a+l*j*Math.sin(u);return e.jsx("circle",{cx:h,cy:f,r:"3",fill:F[x%F.length]},`${x}-${b}`)}))]})}),e.jsx("div",{className:"flex flex-wrap gap-4 justify-center mt-4",children:s.map((c,x)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:F[x%F.length]}}),e.jsx("span",{className:"text-xs text-gray-400",children:c.label})]},x))})]})}function Rs(){const[t,s]=m.useState([]),[r,a]=m.useState(null),[l,o]=m.useState(!1),[n,i]=m.useState(""),d=async g=>{const b=g.target.files;if(!b)return;const p=[...t];for(const j of Array.from(b))try{const u=await j.text(),h=JSON.parse(u);p.push({label:j.name,data:h})}catch{i(`Failed to parse ${j.name}`)}s(p)},c=async()=>{if(t.length<2){i("Need at least 2 flows to compare");return}o(!0),i("");try{const g=await Qe(t.map(b=>b.data),t.map(b=>b.label));a(g)}catch(g){i(g instanceof Error?g.message:"Comparison failed")}finally{o(!1)}},x=g=>{s(b=>b.filter((p,j)=>j!==g)),a(null)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-100",children:"Flow Comparison"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"px-3 py-1.5 text-sm rounded-lg bg-gray-800 text-gray-300 hover:bg-gray-700 transition cursor-pointer",children:["Add Flows",e.jsx("input",{type:"file",accept:".json",multiple:!0,onChange:d,className:"hidden","aria-label":"Upload flow files to compare"})]}),t.length>=2&&e.jsx("button",{onClick:c,disabled:l,className:"px-4 py-1.5 text-sm rounded-lg bg-primary text-white hover:bg-primary/80 transition disabled:opacity-50","aria-label":"Run comparison",children:l?"Comparing...":"Compare"})]})]}),n&&e.jsx("div",{className:"px-4 py-2 rounded-lg bg-red-500/10 border border-red-500/30 text-sm text-red-400",children:n}),t.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:t.map((g,b)=>e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-gray-800 border border-border",children:[e.jsx("span",{className:"text-sm text-gray-300",children:g.label}),e.jsx("button",{onClick:()=>x(b),className:"text-gray-500 hover:text-red-400 transition","aria-label":`Remove ${g.label}`,children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},b))}),t.length===0&&e.jsx("div",{className:"text-center py-12 border-2 border-dashed border-border rounded-lg",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"Upload 2 or more parsed flow JSON files to compare"})}),r&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(Es,{data:r}),e.jsx(Ms,{data:r})]})]})}function As(){m.useEffect(()=>{const t=s=>{if(!(s.metaKey||s.ctrlKey)){if(s.key==="Escape"){const l=N.getState();l.searchOpen?(N.getState().setSearchOpen(!1),s.preventDefault()):l.settingsOpen?(N.getState().setSettingsOpen(!1),s.preventDefault()):l.helpOpen&&(N.getState().setHelpOpen(!1),s.preventDefault())}return}if(s.key==="k"||s.key==="K"){s.preventDefault();const l=N.getState().searchOpen;N.getState().setSearchOpen(!l);return}const a=parseInt(s.key,10);if(a>=1&&a<=8){s.preventDefault(),N.getState().setActiveStep(a-1);return}if(s.key==="9"){s.preventDefault(),N.getState().setActiveStep(8);return}if(s.key==="0"){s.preventDefault(),N.getState().setActiveStep(9);return}};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[])}const de="etl-migration-session",Te="1.0.0",Ls=["parsed","analysis","assessment","notebook","report","finalReport","validation","valueAnalysis","fileName","fileSize","platform"];function $s(t){const s={};for(const r of Ls)s[r]=t[r];return{version:Te,timestamp:Date.now(),state:s}}function Me(){try{localStorage.removeItem(de)}catch(t){console.warn("Session persistence: failed to clear localStorage",t)}}function Ds(){const t=m.useRef(null),s=m.useRef(!1);m.useEffect(()=>{if(!s.current){s.current=!0;try{const r=localStorage.getItem(de);if(!r)return;const a=JSON.parse(r);if(a.version!==Te){Me();return}const l=S.getState(),o=a.state;o.parsed&&l.setParsed(o.parsed),o.analysis&&l.setAnalysis(o.analysis),o.assessment&&l.setAssessment(o.assessment),o.notebook&&l.setNotebook(o.notebook),o.report&&l.setReport(o.report),o.finalReport&&l.setFinalReport(o.finalReport),o.validation&&l.setValidation(o.validation),o.valueAnalysis&&l.setValueAnalysis(o.valueAnalysis),o.fileName&&o.fileSize&&l.setFile(o.fileName,o.fileSize),o.platform&&l.setPlatform(o.platform)}catch(r){console.warn("Session persistence: failed to hydrate from localStorage",r),Me()}}},[]),m.useEffect(()=>{const r=S.subscribe(a=>{t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{try{localStorage.setItem(de,JSON.stringify($s(a)))}catch(l){console.warn("Session persistence: failed to save to localStorage",l)}},500)});return()=>{r(),t.current&&clearTimeout(t.current)}},[])}const Ps={title:"ETL Migration Platform",version:"v5.0.0"},Ts={parse:"Parse Flow",analyze:"Analyze",assess:"Assess & Map",convert:"Convert",report:"Migration Report",finalReport:"Final Report",validate:"Validate",valueAnalysis:"Value Analysis",summary:"Summary",admin:"Admin",dashboard:"Dashboard",history:"Run History",compare:"Compare Flows",versions:"Version History"},Fs={step1:{title:"Parse Flow Definition",description:"Upload and parse your ETL flow definition file"},step2:{title:"Analyze Flow",description:"Deep analysis of flow structure, dependencies, and patterns"},step3:{title:"Assess & Map",description:"Map source processors to Databricks equivalents"},step4:{title:"Convert to Notebooks",description:"Generate Databricks notebook code"},step5:{title:"Migration Report",description:"Gap analysis, risk matrix, and timeline"},step6:{title:"Final Report",description:"Executive summary and comprehensive report"},step7:{title:"Validate",description:"Validate generated code quality"},step8:{title:"Value Analysis",description:"ROI estimation and optimization recommendations"}},Os={upload:"Upload File",run:"Run",autoRun:"Auto-Run All",export:"Export",exportPdf:"Export PDF",reset:"Reset",next:"Next Step",previous:"Previous",save:"Save",cancel:"Cancel",delete:"Delete",close:"Close",search:"Search",settings:"Settings",help:"Help",compare:"Compare",saveVersion:"Save Version",viewDiff:"View Diff"},Bs={platform:"Platform",autoDetect:"Auto-detect platform",processors:"Processors",connections:"Connections",processGroups:"Process Groups",confidence:"Confidence",status:"Status",duration:"Duration",fileName:"File Name",noData:"No data available",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Info"},Is={light:"Light",dark:"Dark",system:"System"},zs={online:"Online",users:"Users"},Ws={addComment:"Add a comment...",reply:"Reply",delete:"Delete",noComments:"No comments yet"},Us={title:"Run History",noRuns:"No runs recorded yet",viewDetail:"View Details"},Vs={title:"Portfolio Dashboard",totalRuns:"Total Runs",successRate:"Success Rate",avgDuration:"Avg Duration",totalProcessors:"Total Processors"},_s={title:"Version History",saveSnapshot:"Save Snapshot",compareDiff:"Compare Versions",noVersions:"No versions saved yet"},Gs={app:Ps,nav:Ts,steps:Fs,buttons:Os,labels:Bs,theme:Is,presence:zs,comments:Ws,history:Us,dashboard:Vs,versioning:_s},xe={en:Gs},Fe="app_locale";function Hs(){try{const t=localStorage.getItem(Fe);if(t&&xe[t])return t}catch(t){console.warn("Translation: failed to read locale from localStorage",t)}return"en"}function Ys(t,s){const r=s.split(".");let a=t;for(const l of r){if(typeof a!="object"||a===null)return s;a=a[l]}return typeof a=="string"?a:s}function Ks(){const[t,s]=m.useState(Hs),r=m.useCallback(l=>{s(l);try{localStorage.setItem(Fe,l)}catch(o){console.warn("Translation: failed to save locale to localStorage",o)}},[]);return{t:m.useCallback((l,o)=>{const n=xe[t]||xe.en,i=Ys(n,l);return i!==l?i:o||l},[t]),locale:t,setLocale:r}}const Js=["nav.parse","nav.analyze","nav.assess","nav.convert","nav.report","nav.finalReport","nav.validate","nav.valueAnalysis","nav.summary","nav.admin","nav.dashboard","nav.history","nav.compare"],qs=["Parse","Analyze","Assess","Convert","Report","Final Report","Validate","Value Analysis","Summary","Admin","Dashboard","History","Compare"],Qs=[De,Xt,ns,ls,is,cs,ds,vs,ws,Xe,ks,Cs,Rs];function Xs(){const t=N(l=>l.activeStep),s=N(l=>l.setActiveStep),r=N(l=>l.stepStatuses),{t:a}=Ks();return e.jsx("div",{className:"shrink-0 border-b border-border bg-gray-900/50 dark:bg-gray-900/50 overflow-x-auto",role:"tablist","aria-label":"Pipeline steps",children:e.jsx("div",{className:"flex gap-0.5 px-2 py-1",children:Js.map((l,o)=>{const n=a(l,qs[o]),i=o<10?r[o]:"idle",d=i==="done"?"bg-green-400":i==="running"?"bg-primary animate-pulse":i==="error"?"bg-red-400":"bg-gray-600";return e.jsxs("button",{role:"tab","aria-selected":o===t,"aria-label":`${n} step${i!=="idle"?`, status: ${i}`:""}`,onClick:()=>s(o),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-t-lg text-xs font-medium transition shrink-0
                ${o===t?"bg-gray-800 text-gray-100 border-b-2 border-primary":"text-gray-500 hover:text-gray-300 hover:bg-gray-800/50"}`,children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${d}`}),o<8?`${o+1}. `:"",n]},o)})})})}function Zs(){const t=N(o=>o.activeStep),s=N(o=>o.sidebarMode),r=N(o=>o.pipelineRunning);As(),Ds();const a=Qs[t]||De,l=r||N.getState().stepStatuses.some(o=>o==="running");return e.jsxs("div",{className:"h-screen flex flex-col bg-gray-950 dark:bg-gray-950 text-gray-100 dark:text-gray-100",children:[e.jsx(Ft,{}),e.jsx(ct,{}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[s?e.jsx(gt,{}):null,e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[!s&&e.jsx(Xs,{}),e.jsx("main",{id:"main-content",className:"flex-1 overflow-y-auto p-6",role:"main",tabIndex:-1,children:e.jsx("div",{className:"max-w-5xl mx-auto",children:l?e.jsx(vt,{}):e.jsx(a,{})})})]})]}),e.jsx(ht,{}),e.jsx(bt,{}),e.jsx(ft,{}),e.jsx(St,{}),e.jsx(Et,{}),e.jsx(At,{}),e.jsx(Tt,{})]})}function rr(){return e.jsx(Zs,{})}export{rr as default};
